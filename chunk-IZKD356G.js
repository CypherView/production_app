import{a as mi}from"./chunk-5MHRBT53.js";import{a as di}from"./chunk-PQZ2WFRV.js";import"./chunk-2MGCTFZV.js";import{a as He,b as Be}from"./chunk-T6NY3GMV.js";import"./chunk-XGZWX4PW.js";import"./chunk-KAPCDYJA.js";import"./chunk-ZDWK5NB6.js";import{T as ci,U as ft}from"./chunk-2YP72RBM.js";import"./chunk-RCAL2UNJ.js";import"./chunk-FNP4CVQN.js";import"./chunk-QVSLGYTS.js";import{a as li,b as Ie,c as ut}from"./chunk-QJYXX6WB.js";import{a as fe,b as ge}from"./chunk-JJVUWK2A.js";import{a as Ze,b as oe,c as mt,d as Qn,e as jn,f as dt,g as Gn,i as ai,j as oi,m as si}from"./chunk-JHHTYGX5.js";import"./chunk-FVFSV3SV.js";import{f as Oe,g as ke,h as Fe,i as pt,j as Ne}from"./chunk-YPVSUJNA.js";import"./chunk-UJGTUYJO.js";import"./chunk-GVCBKH6U.js";import"./chunk-PHOSYVDR.js";import"./chunk-UUBV4PLA.js";import{d as ri}from"./chunk-T2ASJLBG.js";import"./chunk-K3QSXHYQ.js";import{a as Kn,b as Jn,c as ei,d as ti,e as ni,f as ii}from"./chunk-L7NFYEY5.js";import"./chunk-BEAFDC2I.js";import"./chunk-53JQ5NAG.js";import"./chunk-GV42Z4ED.js";import"./chunk-SDMJKPKX.js";import{O as pe,P as ue,n as ce,r as me,z as de}from"./chunk-HBFOC76W.js";import"./chunk-MI5GPO5K.js";import"./chunk-PH5YALHE.js";import{l as se,m as le}from"./chunk-6C6CC4KT.js";import{xa as st}from"./chunk-JAXNIEKX.js";import{Ac as Bn,Bc as Wn,Cc as ve,Dc as ct,E as Pn,Ec as Ln,Fc as zn,Gc as qn,Hc as xn,Ic as Yn,J as An,Jc as $n,K as On,Kc as vn,L as kn,Lc as Un,M as Fn,Mc as Vn,Nc as Xn,Pc as N,R as X,Rc as bn,T as Xe,Wc as Zn,e as ot,nc as lt,oc as Ae,p as Pe,pc as V,qc as he,r as ie,rc as Nn,s as Mn,sc as fn,tc as gn,u as re,uc as hn,vc as P,wc as h,xc as De,yc as ae,zc as Hn}from"./chunk-FEC2V4R3.js";import{Ac as q,D as In,F as ee,Hc as Ge,Jb as D,Jc as Rn,Kb as I,Nb as it,Ob as rt,Pb as y,Qb as r,Rb as a,Rc as u,Sb as d,Sc as xe,Tc as f,Vc as k,Y as Me,Ya as l,Zb as at,Zc as Te,ba as _,bc as O,cc as C,d as wn,e as tt,gc as _e,gd as U,ha as te,hc as we,ia as ne,ic as Ee,j as J,mb as Y,n as Re,na as H,oc as Qe,qc as $,r as En,rc as o,sb as W,sc as R,ta as nt,tc as p,uc as je,x as Tn,yc as L,z as Dn,zc as z}from"./chunk-EG5ORV3B.js";import{a as Ve}from"./chunk-VB56BUGO.js";function be(i,e,t){let n=h(i,t?.in);return isNaN(e)?P(t?.in||i,NaN):(e&&n.setDate(n.getDate()+e),n)}function We(i,e,t){let n=h(i,t?.in);if(isNaN(e))return P(t?.in||i,NaN);if(!e)return n;let s=n.getDate(),c=P(t?.in||i,n.getTime());c.setMonth(n.getMonth()+e+1,0);let m=c.getDate();return s>=m?c:(n.setFullYear(c.getFullYear(),c.getMonth(),s),n)}function Le(i,e,t){return P(t?.in||i,+h(i)+e)}function pi(i,e,t){return Le(i,e*he,t)}function ui(i,e,t){let n=h(i,t?.in);return n.setTime(n.getTime()+e*V),n}function fi(i,e,t){return We(i,e*3,t)}function gi(i,e,t){return Le(i,e*1e3,t)}function hi(i,e,t){return be(i,e*7,t)}function xi(i,e,t){return We(i,e*12,t)}function vi(i,e,t){let[n,s]=ae(t?.in,i,e);return n.getFullYear()-s.getFullYear()}function gt(i,e,t){let[n,s]=ae(t?.in,i,e),c=bi(n,s),m=Math.abs(Bn(n,s));n.setDate(n.getDate()-c*m);let v=+(bi(n,s)===-c),T=c*(m-v);return T===0?0:T}function bi(i,e){let t=i.getFullYear()-e.getFullYear()||i.getMonth()-e.getMonth()||i.getDate()-e.getDate()||i.getHours()-e.getHours()||i.getMinutes()-e.getMinutes()||i.getSeconds()-e.getSeconds()||i.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function yi(i,e,t){let[n,s]=ae(t?.in,i,e),c=(+n-+s)/he;return oe(t?.roundingMethod)(c)}function Si(i,e,t){let n=mt(i,e)/V;return oe(t?.roundingMethod)(n)}function Ci(i,e,t){let n=dt(i,e,t)/3;return oe(t?.roundingMethod)(n)}function _i(i,e,t){let n=gt(i,e,t)/7;return oe(t?.roundingMethod)(n)}function wi(i,e,t){let[n,s]=ae(t?.in,i,e),c=Ze(n,s),m=Math.abs(vi(n,s));n.setFullYear(1584),s.setFullYear(1584);let v=Ze(n,s)===-c,T=c*(m-+v);return T===0?0:T}function Ei(i,e){let t=h(i,e?.in),n=t.getMonth(),s=n-n%3;return t.setMonth(s,1),t.setHours(0,0,0,0),t}function Ti(i,e){let t=h(i,e?.in);return t.setDate(1),t.setHours(0,0,0,0),t}function Di(i,e){let t=h(i,e?.in),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}function Ii(i,e){let t=h(i,e?.in);return t.setMinutes(59,59,999),t}function Ri(i,e){let t=Ae(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=h(i,e?.in),c=s.getDay(),m=(c<n?-7:0)+6-(c-n);return s.setDate(s.getDate()+m),s.setHours(23,59,59,999),s}function Mi(i,e){let t=h(i,e?.in);return t.setSeconds(59,999),t}function Pi(i,e){let t=h(i,e?.in),n=t.getMonth(),s=n-n%3+3;return t.setMonth(s,0),t.setHours(23,59,59,999),t}function Ai(i,e){let t=h(i,e?.in);return t.setMilliseconds(999),t}function Oi(i,e,t){let n=Ae(),s=t?.locale??n.locale??lt,c=Ze(i,e);if(isNaN(c))throw new RangeError("Invalid time value");let m=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:c}),[v,T]=ae(t?.in,...c>0?[e,i]:[i,e]),S=oe(t?.roundingMethod??"round"),B=T.getTime()-v.getTime(),Se=B/V,Ue=De(T)-De(v),Ce=(B-Ue)/V,Z=t?.unit,F;if(Z?F=Z:Se<1?F="second":Se<60?F="minute":Se<hn?F="hour":Ce<gn?F="day":Ce<fn?F="month":F="year",F==="second"){let x=S(B/1e3);return s.formatDistance("xSeconds",x,m)}else if(F==="minute"){let x=S(Se);return s.formatDistance("xMinutes",x,m)}else if(F==="hour"){let x=S(Se/60);return s.formatDistance("xHours",x,m)}else if(F==="day"){let x=S(Ce/hn);return s.formatDistance("xDays",x,m)}else if(F==="month"){let x=S(Ce/gn);return x===12&&Z!=="month"?s.formatDistance("xYears",1,m):s.formatDistance("xMonths",x,m)}else{let x=S(Ce/fn);return s.formatDistance("xYears",x,m)}}function ki(i,e){let t=h(i,e?.in).getDay();return t===0?7:t}function Fi(i,e){let t=Qi(e)?new e(0):P(e,0);return t.setFullYear(i.getFullYear(),i.getMonth(),i.getDate()),t.setHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),t}function Qi(i){return typeof i=="function"&&i.prototype?.constructor===i}var ji=10,ht=class{subPriority=0;validate(e,t){return!0}},xt=class extends ht{constructor(e,t,n,s,c){super(),this.value=e,this.validateValue=t,this.setValue=n,this.priority=s,c&&(this.subPriority=c)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,n){return this.setValue(e,t,this.value,n)}},vt=class extends ht{priority=ji;subPriority=-1;constructor(e,t){super(),this.context=e||(n=>P(t,n))}set(e,t){return t.timestampIsSet?e:P(e,Fi(e,this.context))}};var g=class{run(e,t,n,s){let c=this.parse(e,t,n,s);return c?{setter:new xt(c.value,this.validate,this.set,this.priority,this.subPriority),rest:c.rest}:null}validate(e,t,n){return!0}};var bt=class extends g{priority=140;parse(e,t,n){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});case"GGGG":default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}set(e,t,n){return t.era=n,e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]};var E={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Q={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function M(i,e){return i&&{value:e(i.value),rest:i.rest}}function w(i,e){let t=e.match(i);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function j(i,e){let t=e.match(i);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};let n=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,c=t[3]?parseInt(t[3],10):0,m=t[5]?parseInt(t[5],10):0;return{value:n*(s*he+c*V+m*Nn),rest:e.slice(t[0].length)}}function yt(i){return w(E.anyDigitsSigned,i)}function b(i,e){switch(i){case 1:return w(E.singleDigit,e);case 2:return w(E.twoDigits,e);case 3:return w(E.threeDigits,e);case 4:return w(E.fourDigits,e);default:return w(new RegExp("^\\d{1,"+i+"}"),e)}}function ze(i,e){switch(i){case 1:return w(E.singleDigitSigned,e);case 2:return w(E.twoDigitsSigned,e);case 3:return w(E.threeDigitsSigned,e);case 4:return w(E.fourDigitsSigned,e);default:return w(new RegExp("^-?\\d{1,"+i+"}"),e)}}function qe(i){switch(i){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function St(i,e){let t=e>0,n=t?e:1-e,s;if(n<=50)s=i||100;else{let c=n+50,m=Math.trunc(c/100)*100,v=i>=c%100;s=i+m-(v?100:0)}return t?s:1-s}function Ct(i){return i%400===0||i%4===0&&i%100!==0}var _t=class extends g{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,t,n){let s=c=>({year:c,isTwoDigitYear:t==="yy"});switch(t){case"y":return M(b(4,e),s);case"yo":return M(n.ordinalNumber(e,{unit:"year"}),s);default:return M(b(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n){let s=e.getFullYear();if(n.isTwoDigitYear){let m=St(n.year,s);return e.setFullYear(m,0,1),e.setHours(0,0,0,0),e}let c=!("era"in t)||t.era===1?n.year:1-n.year;return e.setFullYear(c,0,1),e.setHours(0,0,0,0),e}};var wt=class extends g{priority=130;parse(e,t,n){let s=c=>({year:c,isTwoDigitYear:t==="YY"});switch(t){case"Y":return M(b(4,e),s);case"Yo":return M(n.ordinalNumber(e,{unit:"year"}),s);default:return M(b(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n,s){let c=zn(e,s);if(n.isTwoDigitYear){let v=St(n.year,c);return e.setFullYear(v,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),ve(e,s)}let m=!("era"in t)||t.era===1?n.year:1-n.year;return e.setFullYear(m,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),ve(e,s)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]};var Et=class extends g{priority=130;parse(e,t){return t==="R"?ze(4,e):ze(t.length,e)}set(e,t,n){let s=P(e,0);return s.setFullYear(n,0,4),s.setHours(0,0,0,0),ct(s)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]};var Tt=class extends g{priority=130;parse(e,t){return t==="u"?ze(4,e):ze(t.length,e)}set(e,t,n){return e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]};var Dt=class extends g{priority=120;parse(e,t,n){switch(t){case"Q":case"QQ":return b(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth((n-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]};var It=class extends g{priority=120;parse(e,t,n){switch(t){case"q":case"qq":return b(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth((n-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]};var Rt=class extends g{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,t,n){let s=c=>c-1;switch(t){case"M":return M(w(E.month,e),s);case"MM":return M(b(2,e),s);case"Mo":return M(n.ordinalNumber(e,{unit:"month"}),s);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}};var Mt=class extends g{priority=110;parse(e,t,n){let s=c=>c-1;switch(t){case"L":return M(w(E.month,e),s);case"LL":return M(b(2,e),s);case"Lo":return M(n.ordinalNumber(e,{unit:"month"}),s);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};function Ni(i,e,t){let n=h(i,t?.in),s=qn(n,t)-e;return n.setDate(n.getDate()-s*7),h(n,t?.in)}var Pt=class extends g{priority=100;parse(e,t,n){switch(t){case"w":return w(E.week,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return b(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n,s){return ve(Ni(e,n,s),s)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};function Hi(i,e,t){let n=h(i,t?.in),s=Ln(n,t)-e;return n.setDate(n.getDate()-s*7),n}var At=class extends g{priority=100;parse(e,t,n){switch(t){case"I":return w(E.week,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return b(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n){return ct(Hi(e,n))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};var Gi=[31,28,31,30,31,30,31,31,30,31,30,31],Xi=[31,29,31,30,31,30,31,31,30,31,30,31],Ot=class extends g{priority=90;subPriority=1;parse(e,t,n){switch(t){case"d":return w(E.date,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return b(t.length,e)}}validate(e,t){let n=e.getFullYear(),s=Ct(n),c=e.getMonth();return s?t>=1&&t<=Xi[c]:t>=1&&t<=Gi[c]}set(e,t,n){return e.setDate(n),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]};var kt=class extends g{priority=90;subpriority=1;parse(e,t,n){switch(t){case"D":case"DD":return w(E.dayOfYear,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return b(t.length,e)}}validate(e,t){let n=e.getFullYear();return Ct(n)?t>=1&&t<=366:t>=1&&t<=365}set(e,t,n){return e.setMonth(0,n),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};function Ye(i,e,t){let n=Ae(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,c=h(i,t?.in),m=c.getDay(),T=(e%7+7)%7,S=7-s,B=e<0||e>6?e-(m+S)%7:(T+S)%7-(m+S)%7;return be(c,B,t)}var Ft=class extends g{priority=90;parse(e,t,n){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,s){return e=Ye(e,n,s),e.setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]};var Nt=class extends g{priority=90;parse(e,t,n,s){let c=m=>{let v=Math.floor((m-1)/7)*7;return(m+s.weekStartsOn+6)%7+v};switch(t){case"e":case"ee":return M(b(t.length,e),c);case"eo":return M(n.ordinalNumber(e,{unit:"day"}),c);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,s){return e=Ye(e,n,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]};var Ht=class extends g{priority=90;parse(e,t,n,s){let c=m=>{let v=Math.floor((m-1)/7)*7;return(m+s.weekStartsOn+6)%7+v};switch(t){case"c":case"cc":return M(b(t.length,e),c);case"co":return M(n.ordinalNumber(e,{unit:"day"}),c);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,s){return e=Ye(e,n,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};function Bi(i,e,t){let n=h(i,t?.in),s=ki(n,t),c=e-s;return be(n,c,t)}var Bt=class extends g{priority=90;parse(e,t,n){let s=c=>c===0?7:c;switch(t){case"i":case"ii":return b(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return M(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),s);case"iiiii":return M(n.day(e,{width:"narrow",context:"formatting"}),s);case"iiiiii":return M(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),s);case"iiii":default:return M(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),s)}}validate(e,t){return t>=1&&t<=7}set(e,t,n){return e=Bi(e,n),e.setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]};var Wt=class extends g{priority=80;parse(e,t,n){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(qe(n),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]};var Lt=class extends g{priority=80;parse(e,t,n){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(qe(n),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]};var zt=class extends g{priority=80;parse(e,t,n){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(qe(n),0,0,0),e}incompatibleTokens=["a","b","t","T"]};var qt=class extends g{priority=70;parse(e,t,n){switch(t){case"h":return w(E.hour12h,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return b(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,n){let s=e.getHours()>=12;return s&&n<12?e.setHours(n+12,0,0,0):!s&&n===12?e.setHours(0,0,0,0):e.setHours(n,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]};var Yt=class extends g{priority=70;parse(e,t,n){switch(t){case"H":return w(E.hour23h,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return b(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,n){return e.setHours(n,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]};var $t=class extends g{priority=70;parse(e,t,n){switch(t){case"K":return w(E.hour11h,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return b(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.getHours()>=12&&n<12?e.setHours(n+12,0,0,0):e.setHours(n,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]};var Ut=class extends g{priority=70;parse(e,t,n){switch(t){case"k":return w(E.hour24h,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return b(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,n){let s=n<=24?n%24:n;return e.setHours(s,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]};var Vt=class extends g{priority=60;parse(e,t,n){switch(t){case"m":return w(E.minute,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return b(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setMinutes(n,0,0),e}incompatibleTokens=["t","T"]};var Qt=class extends g{priority=50;parse(e,t,n){switch(t){case"s":return w(E.second,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return b(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setSeconds(n,0),e}incompatibleTokens=["t","T"]};var jt=class extends g{priority=30;parse(e,t){let n=s=>Math.trunc(s*Math.pow(10,-t.length+3));return M(b(t.length,e),n)}set(e,t,n){return e.setMilliseconds(n),e}incompatibleTokens=["t","T"]};var Gt=class extends g{priority=10;parse(e,t){switch(t){case"X":return j(Q.basicOptionalMinutes,e);case"XX":return j(Q.basic,e);case"XXXX":return j(Q.basicOptionalSeconds,e);case"XXXXX":return j(Q.extendedOptionalSeconds,e);case"XXX":default:return j(Q.extended,e)}}set(e,t,n){return t.timestampIsSet?e:P(e,e.getTime()-De(e)-n)}incompatibleTokens=["t","T","x"]};var Xt=class extends g{priority=10;parse(e,t){switch(t){case"x":return j(Q.basicOptionalMinutes,e);case"xx":return j(Q.basic,e);case"xxxx":return j(Q.basicOptionalSeconds,e);case"xxxxx":return j(Q.extendedOptionalSeconds,e);case"xxx":default:return j(Q.extended,e)}}set(e,t,n){return t.timestampIsSet?e:P(e,e.getTime()-De(e)-n)}incompatibleTokens=["t","T","X"]};var Zt=class extends g{priority=40;parse(e){return yt(e)}set(e,t,n){return[P(e,n*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"};var Kt=class extends g{priority=20;parse(e){return yt(e)}set(e,t,n){return[P(e,n),{timestampIsSet:!0}]}incompatibleTokens="*"};var Wi={G:new bt,y:new _t,Y:new wt,R:new Et,u:new Tt,Q:new Dt,q:new It,M:new Rt,L:new Mt,w:new Pt,I:new At,d:new Ot,D:new kt,E:new Ft,e:new Nt,c:new Ht,i:new Bt,a:new Wt,b:new Lt,B:new zt,h:new qt,H:new Yt,K:new $t,k:new Ut,m:new Vt,s:new Qt,S:new jt,X:new Gt,x:new Xt,t:new Zt,T:new Kt};var Zi=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ki=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ji=/^'([^]*?)'?$/,er=/''/g,tr=/\S/,nr=/[a-zA-Z]/;function Li(i,e,t,n){let s=()=>P(n?.in||t,NaN),c=Xn(),m=n?.locale??c.locale??lt,v=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??c.firstWeekContainsDate??c.locale?.options?.firstWeekContainsDate??1,T=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??c.weekStartsOn??c.locale?.options?.weekStartsOn??0;if(!e)return i?s():h(t,n?.in);let S={firstWeekContainsDate:v,weekStartsOn:T,locale:m},B=[new vt(n?.in,t)],Se=e.match(Ki).map(x=>{let A=x[0];if(A in xn){let K=xn[A];return K(x,m.formatLong)}return x}).join("").match(Zi),Ue=[];for(let x of Se){!n?.useAdditionalWeekYearTokens&&$n(x)&&vn(x,e,i),!n?.useAdditionalDayOfYearTokens&&Yn(x)&&vn(x,e,i);let A=x[0],K=Wi[A];if(K){let{incompatibleTokens:Sn}=K;if(Array.isArray(Sn)){let Cn=Ue.find(_n=>Sn.includes(_n.token)||_n.token===A);if(Cn)throw new RangeError(`The format string mustn't contain \`${Cn.fullToken}\` and \`${x}\` at the same time`)}else if(K.incompatibleTokens==="*"&&Ue.length>0)throw new RangeError(`The format string mustn't contain \`${x}\` and any other token at the same time`);Ue.push({token:A,fullToken:x});let un=K.run(i,x,m.match,S);if(!un)return s();B.push(un.setter),i=un.rest}else{if(A.match(nr))throw new RangeError("Format string contains an unescaped latin alphabet character `"+A+"`");if(x==="''"?x="'":A==="'"&&(x=ir(x)),i.indexOf(x)===0)i=i.slice(x.length);else return s()}}if(i.length>0&&tr.test(i))return s();let Ce=B.map(x=>x.priority).sort((x,A)=>A-x).filter((x,A,K)=>K.indexOf(x)===A).map(x=>B.filter(A=>A.priority===x).sort((A,K)=>K.subPriority-A.subPriority)).map(x=>x[0]),Z=h(t,n?.in);if(isNaN(+Z))return s();let F={};for(let x of Ce){if(!x.validate(Z,S))return s();let A=x.set(Z,F,S);Array.isArray(A)?(Z=A[0],Object.assign(F,A[1])):Z=A}return Z}function ir(i){return i.match(Ji)[1].replace(er,"'")}function zi(i,e){let t=h(i,e?.in);return t.setMinutes(0,0,0),t}function qi(i,e){let t=h(i,e?.in);return t.setSeconds(0,0),t}function Yi(i,e){let t=h(i,e?.in);return t.setMilliseconds(0),t}function Je(i,e){let t=()=>P(e?.in,NaN),n=e?.additionalDigits??2,s=sr(i),c;if(s.date){let S=lr(s.date,n);c=cr(S.restDateString,S.year)}if(!c||isNaN(+c))return t();let m=+c,v=0,T;if(s.time&&(v=mr(s.time),isNaN(v)))return t();if(s.timezone){if(T=dr(s.timezone),isNaN(T))return t()}else{let S=new Date(m+v),B=h(0,e?.in);return B.setFullYear(S.getUTCFullYear(),S.getUTCMonth(),S.getUTCDate()),B.setHours(S.getUTCHours(),S.getUTCMinutes(),S.getUTCSeconds(),S.getUTCMilliseconds()),B}return h(m+v+T,e?.in)}var Jt={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},rr=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ar=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,or=/^([+-])(\d{2})(?::?(\d{2}))?$/;function sr(i){let e={},t=i.split(Jt.dateTimeDelimiter),n;if(t.length>2)return e;if(/:/.test(t[0])?n=t[0]:(e.date=t[0],n=t[1],Jt.timeZoneDelimiter.test(e.date)&&(e.date=i.split(Jt.timeZoneDelimiter)[0],n=i.substr(e.date.length,i.length))),n){let s=Jt.timezone.exec(n);s?(e.time=n.replace(s[1],""),e.timezone=s[1]):e.time=n}return e}function lr(i,e){let t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=i.match(t);if(!n)return{year:NaN,restDateString:""};let s=n[1]?parseInt(n[1]):null,c=n[2]?parseInt(n[2]):null;return{year:c===null?s:c*100,restDateString:i.slice((n[1]||n[2]).length)}}function cr(i,e){if(e===null)return new Date(NaN);let t=i.match(rr);if(!t)return new Date(NaN);let n=!!t[4],s=Ke(t[1]),c=Ke(t[2])-1,m=Ke(t[3]),v=Ke(t[4]),T=Ke(t[5])-1;if(n)return hr(e,v,T)?pr(e,v,T):new Date(NaN);{let S=new Date(0);return!fr(e,c,m)||!gr(e,s)?new Date(NaN):(S.setUTCFullYear(e,c,Math.max(s,m)),S)}}function Ke(i){return i?parseInt(i):1}function mr(i){let e=i.match(ar);if(!e)return NaN;let t=yn(e[1]),n=yn(e[2]),s=yn(e[3]);return xr(t,n,s)?t*he+n*V+s*1e3:NaN}function yn(i){return i&&parseFloat(i.replace(",","."))||0}function dr(i){if(i==="Z")return 0;let e=i.match(or);if(!e)return 0;let t=e[1]==="+"?-1:1,n=parseInt(e[2]),s=e[3]&&parseInt(e[3])||0;return vr(n,s)?t*(n*he+s*V):NaN}function pr(i,e,t){let n=new Date(0);n.setUTCFullYear(i,0,4);let s=n.getUTCDay()||7,c=(e-1)*7+t+1-s;return n.setUTCDate(n.getUTCDate()+c),n}var ur=[31,null,31,30,31,30,31,31,30,31,30,31];function $i(i){return i%400===0||i%4===0&&i%100!==0}function fr(i,e,t){return e>=0&&e<=11&&t>=1&&t<=(ur[e]||($i(i)?29:28))}function gr(i,e){return e>=1&&e<=($i(i)?366:365)}function hr(i,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function xr(i,e,t){return i===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&i>=0&&i<25}function vr(i,e){return e>=0&&e<=59}var br={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};li._date.override({_id:"date-fns",formats:function(){return br},parse:function(i,e){if(i===null||typeof i>"u")return null;let t=typeof i;return t==="number"||i instanceof Date?i=h(i):t==="string"&&(typeof e=="string"?i=Li(i,e,new Date,this.options):i=Je(i,this.options)),Un(i)?i.getTime():null},format:function(i,e){return Vn(i,e,this.options)},add:function(i,e,t){switch(t){case"millisecond":return Le(i,e);case"second":return gi(i,e);case"minute":return ui(i,e);case"hour":return pi(i,e);case"day":return be(i,e);case"week":return hi(i,e);case"month":return We(i,e);case"quarter":return fi(i,e);case"year":return xi(i,e);default:return i}},diff:function(i,e,t){switch(t){case"millisecond":return mt(i,e);case"second":return Gn(i,e);case"minute":return Si(i,e);case"hour":return yi(i,e);case"day":return gt(i,e);case"week":return _i(i,e);case"month":return dt(i,e);case"quarter":return Ci(i,e);case"year":return wi(i,e);default:return 0}},startOf:function(i,e,t){switch(e){case"second":return Yi(i);case"minute":return qi(i);case"hour":return zi(i);case"day":return Hn(i);case"week":return ve(i);case"isoWeek":return ve(i,{weekStartsOn:+t});case"month":return Ti(i);case"quarter":return Ei(i);case"year":return Wn(i);default:return i}},endOf:function(i,e){switch(e){case"second":return Ai(i);case"minute":return Mi(i);case"hour":return Ii(i);case"day":return Qn(i);case"week":return Ri(i);case"month":return jn(i);case"quarter":return Pi(i);case"year":return Di(i);default:return i}}});var $e=class i{ws=null;config=null;reconnectAttempt=0;messageSubject=new wn;statusSubject=new tt(!1);destroyRef=_(H);messages$=this.messageSubject.asObservable();status$=this.statusSubject.asObservable();connect(e){this.config=Ve({reconnectInterval:5e3,reconnectAttempts:10,heartbeatInterval:3e4},e),this.createConnection()}disconnect(){this.ws&&(this.ws.close(),this.ws=null,this.statusSubject.next(!1))}send(e){this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify(e)):console.error("WebSocket is not connected")}subscribe(e){this.send({type:"subscribe",topics:e})}createConnection(){if(this.config)try{this.ws=new WebSocket(this.config.url),this.ws.onopen=()=>{this.statusSubject.next(!0),this.reconnectAttempt=0,this.subscribe(["health","metrics","alerts"])},this.ws.onmessage=e=>{try{let t=JSON.parse(e.data);this.messageSubject.next(t)}catch(t){console.error("Error parsing WebSocket message:",t)}},this.ws.onerror=e=>{console.error("WebSocket error:",e)},this.ws.onclose=()=>{this.statusSubject.next(!1),this.attemptReconnect()}}catch(e){console.error("Error creating WebSocket connection:",e),this.attemptReconnect()}}attemptReconnect(){if(!this.config)return;let e=this.config.reconnectAttempts??10;if(this.reconnectAttempt>=e){console.error("Max reconnection attempts reached");return}this.reconnectAttempt++;let t=this.config.reconnectInterval??5e3;Dn(t).pipe(N(this.destroyRef)).subscribe(()=>{this.createConnection()})}isConnected(){return this.ws?.readyState===WebSocket.OPEN}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Me({token:i,factory:i.\u0275fac,providedIn:"root"})};var en=class i{broadcastService=_(Zn);broadcastHealthUpdate(e){this.broadcastService.broadcast("system-health-update",{data:e,timestamp:new Date().toISOString()})}broadcastWebSocketStatus(e,t){this.broadcastService.broadcast("websocket-status-change",{connected:e,reason:t})}broadcastServiceAlert(e,t,n){this.broadcastService.broadcast("health-service-alert",{serviceName:e,severity:t,message:n})}onHealthUpdate(){return this.broadcastService.on("system-health-update")}onWebSocketStatusChange(){return this.broadcastService.on("websocket-status-change")}onServiceAlert(){return this.broadcastService.on("health-service-alert")}onDashboardRefreshRequested(e){return this.broadcastService.broadcast("dashboard-refresh-requested",{source:e??"manual-refresh"})}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Me({token:i,factory:i.\u0275fac,providedIn:"root"})};var G=class i{http=_(Pn);wsService=_($e);broadcastService=_(en);destroyRef=_(H);healthDataSubject=new tt(null);systemHealth$=this.healthDataSubject.asObservable();initialized=!1;initialize(){this.initialized||(this.initialized=!0,this.wsService.connect({url:X.wsUrl,reconnectInterval:5e3,reconnectAttempts:10}),this.wsService.status$.pipe(N(this.destroyRef)).subscribe(e=>{this.broadcastService.broadcastWebSocketStatus(e,e?"Connected":"Disconnected"),e&&this.fetchAllHealthData()}),this.wsService.messages$.pipe(N(this.destroyRef)).subscribe(e=>{this.handleWebSocketMessage(e)}))}handleWebSocketMessage(e){switch(e.type){case"health_update":e.data!=null&&this.updateHealthData(e.data);break;case"service_alert":this.broadcastService.broadcastServiceAlert(e.serviceName,e.severity,e.message);break;default:break}}async fetchAllHealthData(e){try{let[t,n,s,c,m]=await Promise.all([Re(this.fetchServiceDetails(e)),Re(this.fetchFunctions(e)),Re(this.fetchStorageMetrics(e)),Re(this.fetchThroughputMetrics(e)),Re(this.fetchRecentAlerts(e))]),T={overview:{services:t??[],overallHealth:this.calculateOverallHealth(t??[]),lastUpdated:new Date().toISOString()},timeline:[],azureFunctions:n??[],eventFlow:c??{timeRange:e??"1h",averageRequestsPerSecond:0,averageEventsPerSecond:0,averageDependenciesPerSecond:0,peakRequestsPerSecond:0,peakEventsPerSecond:0,totalRequests:0,totalEvents:0,totalDependencies:0,dataPoints:[]},storage:s??{timeRange:e??"1h",totalOperations:0,totalSuccessRate:0,storageServices:[]},alerts:m??{timeRange:e??"1h",totalAlerts:0,criticalCount:0,errorCount:0,warningCount:0,informationCount:0,alerts:[]}};this.healthDataSubject.next(T),this.broadcastService.broadcastHealthUpdate(T)}catch(t){console.error("Error fetching health data:",t)}}fetchServiceDetails(e){let t=e!=null&&e!==""?`?timeRange=${e}`:"",n=`${X.apiUrl}/api/health/service-details${t}`;return this.http.get(n).pipe(ee(s=>(console.error("Error fetching service details:",s),J(null))))}fetchFunctions(e){let t=e!=null&&e!==""?`?timeRange=${e}`:"",n=`${X.apiUrl}/api/health/functions${t}`;return this.http.get(n).pipe(ee(s=>(console.error("Error fetching functions:",s),J(null))))}fetchStorageMetrics(e){let t=e!=null&&e!==""?`?timeRange=${e}`:"",n=`${X.apiUrl}/api/metrics/storage${t}`;return this.http.get(n).pipe(ee(s=>(console.error("Error fetching storage metrics:",s),J(null))))}fetchThroughputMetrics(e){let t=e!=null&&e!==""?`?timeRange=${e}`:"",n=`${X.apiUrl}/api/metrics/throughput${t}`;return this.http.get(n).pipe(ee(s=>(console.error("Error fetching throughput metrics:",s),J(null))))}fetchRecentAlerts(e){let t=e!=null&&e!==""?`?timeRange=${e}`:"",n=`${X.apiUrl}/api/alerts/recent${t}`;return this.http.get(n).pipe(ee(s=>(console.error("Error fetching recent alerts:",s),J(null))))}fetchErrorTimeline(e){let t=e!=null&&e!==""?`?timeRange=${e}`:"",n=`${X.apiUrl}/api/alerts/timeline${t}`;return this.http.get(n).pipe(ee(s=>(console.error("Error fetching error timeline:",s),J(null))))}updateHealthData(e){let t=this.healthDataSubject.value;if(t){let n=Ve(Ve({},t),e);this.healthDataSubject.next(n),this.broadcastService.broadcastHealthUpdate(n)}}fetchFunctionTimeline(e,t){let n=new URLSearchParams;Xe(e)&&n.append("timeRange",e),Xe(t)&&n.append("granularity",t);let s=n.toString()?`?${n.toString()}`:"",c=`${X.apiUrl}/api/health/functions/timeline${s}`;return this.http.get(c).pipe(ee(m=>(console.error("Error fetching function timeline:",m),J(null))))}fetchFunctionResources(e){let t=e!=null&&e!==""?`?timeRange=${e}`:"",n=`${X.apiUrl}/api/health/functions/resources${t}`;return this.http.get(n).pipe(ee(s=>(console.error("Error fetching function resources:",s),J(null))))}fetchFunctionDependencies(e){let t=e!=null&&e!==""?`?timeRange=${e}`:"",n=`${X.apiUrl}/api/health/functions/dependencies${t}`;return this.http.get(n).pipe(ee(s=>(console.error("Error fetching function dependencies:",s),J(null))))}refreshData(e){this.fetchAllHealthData(e)}getCurrentHealthData(){return this.healthDataSubject.value}fetchAlerts(e){return this.fetchRecentAlerts(e)}fetchServices(e){return this.fetchServiceDetails(e)}fetchAzureFunctions(e){return this.fetchFunctions(e)}fetchStorage(e){return this.fetchStorageMetrics(e)}fetchEventFlow(e){return this.fetchThroughputMetrics(e)}fetchErrorTimelineData(e){return this.fetchErrorTimeline(e)}calculateOverallHealth(e){if(e.length===0)return"Healthy";let t=e.filter(s=>s.status==="Critical").length,n=e.filter(s=>s.status==="Warning").length;return t>0?"Critical":n>0?"Warning":"Healthy"}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Me({token:i,factory:i.\u0275fac,providedIn:"root"})};var yr=["timelineCanvas"],Sr=["coldStartCanvas"],Cr=()=>[5,10,20,50],_r=(i,e)=>e.dependencyName;function wr(i,e){if(i&1&&(r(0,"div",12)(1,"p-card")(2,"div",26)(3,"div",27),o(4),a(),r(5,"div",28),o(6,"Total Functions"),a()()(),r(7,"p-card")(8,"div",26)(9,"div",29),o(10),u(11,"number"),a(),r(12,"div",28),o(13,"Total Executions"),a()()(),r(14,"p-card")(15,"div",26)(16,"div",30),o(17),u(18,"number"),a(),r(19,"div",28),o(20,"Avg Success Rate"),a()()(),r(21,"p-card")(22,"div",26)(23,"div",31),o(24),u(25,"number"),a(),r(26,"div",28),o(27,"Cold Starts"),a()()()()),i&2){let t=C();l(4),p(" ",t.functions.length," "),l(6),p(" ",f(11,4,t.getTotalExecutions(),"1.0-0")," "),l(7),p(" ",f(18,7,t.getAverageSuccessRate(),"1.1-1"),"% "),l(7),p(" ",f(25,10,t.resources.totalColdStarts,"1.0-0")," ")}}function Er(i,e){i&1&&(r(0,"div",18),d(1,"i",32),r(2,"p",33),o(3,"Loading functions data..."),a()())}function Tr(i,e){i&1&&(r(0,"div",18),d(1,"i",34),r(2,"p",35),o(3,"No functions data available"),a()())}function Dr(i,e){i&1&&(r(0,"tr"),d(1,"th",36),r(2,"th",37),o(3," Function Name "),d(4,"p-sortIcon",38),a(),r(5,"th",39),o(6," Status "),d(7,"p-sortIcon",40),a(),r(8,"th",41),o(9," Executions "),d(10,"p-sortIcon",42),a(),r(11,"th",43),o(12," Success Rate "),d(13,"p-sortIcon",44),a(),r(14,"th",45),o(15," Avg Duration "),d(16,"p-sortIcon",46),a(),r(17,"th",47),o(18," P95 Duration "),d(19,"p-sortIcon",48),a(),r(20,"th",49),o(21," Last Execution "),d(22,"p-sortIcon",50),a()())}function Ir(i,e){if(i&1&&(r(0,"tr")(1,"td"),d(2,"p-button",51),a(),r(3,"td")(4,"span"),o(5),a()(),r(6,"td"),d(7,"p-tag",52),a(),r(8,"td",53),o(9),u(10,"number"),a(),r(11,"td",53)(12,"span"),o(13),u(14,"number"),a()(),r(15,"td",53),o(16),a(),r(17,"td",53),o(18),a(),r(19,"td"),o(20),u(21,"date"),a()()),i&2){let t=e.$implicit,n=e.expanded,s=C(2);l(2),y("pRowToggler",t)("icon",n?"pi pi-chevron-down":"pi pi-chevron-right"),l(3),R(t.functionName),l(2),y("value",t.status)("severity",s.getStatusSeverity(t.status))("icon","pi "+s.getStatusIcon(t.status)),l(2),p(" ",f(10,13,t.totalExecutions,"1.0-0")," "),l(3),$(t.successRate>=99?"text-green-800 font-semibold":t.successRate>=95?"text-yellow-800 font-semibold":"text-red-800 font-semibold"),l(),p(" ",f(14,16,t.successRate,"1.2-2"),"% "),l(3),p(" ",s.formatDuration(t.avgDuration)," "),l(2),p(" ",s.formatDuration(t.p95Duration)," "),l(2),R(f(21,19,t.lastExecution,"short"))}}function Rr(i,e){if(i&1&&(r(0,"div")(1,"div",62),o(2),a(),r(3,"div",68),o(4),u(5,"number"),a()()),i&2){let t=e.$implicit;$("text-sm border-l-2 pl-2 "+(t.errorRate>5?"border-red-500":"border-green-500")),l(2),je(" ",t.dependencyType,": ",t.dependencyName," "),l(2),je(" ",t.totalCalls," calls, ",f(5,6,t.errorRate,"1.1-1"),"% error rate ")}}function Mr(i,e){if(i&1&&(r(0,"div",59),it(1,Rr,6,9,"div",67,_r),a()),i&2){let t=C().$implicit,n=C(2);l(),rt(n.getFunctionDependencies(t.functionName))}}function Pr(i,e){i&1&&(r(0,"p",66),o(1," No dependencies tracked "),a())}function Ar(i,e){if(i&1&&(r(0,"tr")(1,"td",54)(2,"div",55)(3,"h4",56),o(4),a(),r(5,"div",57)(6,"p-card",58)(7,"div",59)(8,"div",60)(9,"span",61),o(10,"Total:"),a(),r(11,"span",62),o(12),u(13,"number"),a()(),r(14,"div",60)(15,"span",61),o(16,"Failed:"),a(),r(17,"span",63),o(18),u(19,"number"),a()(),r(20,"div",60)(21,"span",61),o(22,"Error Rate:"),a(),r(23,"span",62),o(24),u(25,"number"),a()()()(),r(26,"p-card",64)(27,"div",59)(28,"div",60)(29,"span",61),o(30,"Min:"),a(),r(31,"span",62),o(32),a()(),r(33,"div",60)(34,"span",61),o(35,"P50:"),a(),r(36,"span",62),o(37),a()(),r(38,"div",60)(39,"span",61),o(40,"P99:"),a(),r(41,"span",62),o(42),a()(),r(43,"div",60)(44,"span",61),o(45,"Max:"),a(),r(46,"span",62),o(47),a()()()(),r(48,"p-card",65),D(49,Mr,3,0,"div",59)(50,Pr,2,0,"p",66),a()()()()()),i&2){let t=e.$implicit,n=C(2);l(4),p(" ",t.functionName," - Detailed Metrics "),l(8),R(f(13,9,t.totalExecutions,"1.0-0")),l(6),R(f(19,12,t.failedExecutions,"1.0-0")),l(6),p("",f(25,15,t.errorRate,"1.2-2"),"%"),l(8),R(n.formatDuration(t.minDuration)),l(5),R(n.formatDuration(t.p50Duration)),l(5),R(n.formatDuration(t.p99Duration)),l(5),R(n.formatDuration(t.maxDuration)),l(2),I(n.getFunctionDependencies(t.functionName).length>0?49:50)}}function Or(i,e){if(i&1&&(r(0,"p-table",19),W(1,Dr,23,0,"ng-template",null,0,k)(3,Ir,22,22,"ng-template",null,1,k)(5,Ar,51,18,"ng-template",null,2,k),a()),i&2){let t=C();y("value",t.functions)("paginator",!0)("rows",10)("rowsPerPageOptions",Ge(5,Cr))("expandedRowKeys",t.expandedRows)}}function kr(i,e){i&1&&(r(0,"div",18),d(1,"i",32),r(2,"p",33),o(3,"Loading timeline data..."),a()())}function Fr(i,e){i&1&&(r(0,"div",23),d(1,"canvas",null,3),a())}function Nr(i,e){i&1&&(r(0,"div",18),d(1,"i",69),r(2,"p",35),o(3,"No timeline data available"),a()())}function Hr(i,e){i&1&&(r(0,"div",23),d(1,"canvas",null,4),a())}function Br(i,e){i&1&&(r(0,"div",18),d(1,"i",78),r(2,"p",35),o(3,"No cold starts detected"),a(),r(4,"p",79),o(5,"All functions are running optimally"),a()())}function Wr(i,e){i&1&&(r(0,"tr")(1,"th",37),o(2," Function "),d(3,"p-sortIcon",38),a(),r(4,"th",80),o(5," Cold Starts "),d(6,"p-sortIcon",81),a(),r(7,"th",82),o(8," Rate "),d(9,"p-sortIcon",83),a(),r(10,"th",84),o(11," Avg Cold "),d(12,"p-sortIcon",85),a(),r(13,"th",86),o(14," Avg Warm "),d(15,"p-sortIcon",87),a(),r(16,"th",88),o(17," Impact "),d(18,"p-sortIcon",89),a()())}function Lr(i,e){if(i&1&&(r(0,"tr")(1,"td"),o(2),a(),r(3,"td",53),o(4),u(5,"number"),a(),r(6,"td",53)(7,"span"),o(8),u(9,"number"),a()(),r(10,"td",53),o(11),a(),r(12,"td",53),o(13),a(),r(14,"td",53)(15,"span"),o(16),a()()()),i&2){let t=e.$implicit,n=C(3);l(2),R(t.functionName),l(2),p(" ",f(5,10,t.coldStarts,"1.0-0")," "),l(3),$(t.coldStartRate>20?"text-red-800 font-semibold":t.coldStartRate>10?"text-orange-800 font-semibold":"text-green-800"),l(),p(" ",f(9,13,t.coldStartRate,"1.2-2"),"% "),l(3),p(" ",n.formatDuration(t.avgColdStartDuration)," "),l(2),p(" ",n.formatDuration(t.avgWarmStartDuration)," "),l(2),$(t.coldStartImpact>2e3?"text-red-800 font-semibold":"text-gray-800"),l(),p(" +",n.formatDuration(t.coldStartImpact)," ")}}function zr(i,e){if(i&1&&(r(0,"p-table",77),W(1,Wr,19,0,"ng-template",null,0,k)(3,Lr,17,16,"ng-template",null,1,k),a()),i&2){let t=C(2);y("value",t.getFunctionsWithColdStarts())("paginator",!0)("rows",10)}}function qr(i,e){i&1&&(r(0,"div",18),d(1,"i",78),r(2,"p",35),o(3,"No cold starts detected"),a()())}function Yr(i,e){if(i&1&&(r(0,"div",24)(1,"p-card",70)(2,"div",71)(3,"div",26)(4,"div",72),o(5),u(6,"number"),a(),r(7,"div",28),o(8,"Total Cold Starts"),a()(),r(9,"div",26)(10,"div",73),o(11),u(12,"number"),a(),r(13,"div",28),o(14,"Avg Cold Start Rate"),a()(),r(15,"div",26)(16,"div",74),o(17),a(),r(18,"div",28),o(19,"Functions Analyzed"),a()()()(),r(20,"p-card",75),D(21,Hr,3,0,"div",23)(22,Br,6,0,"div",18),a(),r(23,"p-card",76),D(24,zr,5,3,"p-table",77)(25,qr,4,0,"div",18),a()()),i&2){let t=C();l(5),p(" ",f(6,5,t.resources.totalColdStarts,"1.0-0")," "),l(6),p(" ",f(12,8,t.resources.avgColdStartRate,"1.2-2"),"% "),l(6),p(" ",t.resources.functions.length," "),l(4),I(t.getFunctionsWithColdStarts().length>0?21:22),l(3),I(t.getFunctionsWithColdStarts().length>0?24:25)}}function $r(i,e){i&1&&(r(0,"tr")(1,"th",37),o(2," Function "),d(3,"p-sortIcon",38),a(),r(4,"th",92),o(5," Type "),d(6,"p-sortIcon",93),a(),r(7,"th",94),o(8," Dependency "),d(9,"p-sortIcon",95),a(),r(10,"th",96),o(11," Calls "),d(12,"p-sortIcon",97),a(),r(13,"th",98),o(14," Failed "),d(15,"p-sortIcon",99),a(),r(16,"th",100),o(17," Error Rate "),d(18,"p-sortIcon",101),a(),r(19,"th",45),o(20," Avg Duration "),d(21,"p-sortIcon",46),a()())}function Ur(i,e){if(i&1&&(r(0,"div",103),o(1),a()),i&2){let t=C().$implicit;l(),p(" ",t.primaryTarget," ")}}function Vr(i,e){if(i&1&&(r(0,"tr")(1,"td"),o(2),a(),r(3,"td")(4,"span"),o(5),a()(),r(6,"td")(7,"div",102),o(8),a(),D(9,Ur,2,1,"div",103),a(),r(10,"td",53),o(11),u(12,"number"),a(),r(13,"td",53)(14,"span"),o(15),u(16,"number"),a()(),r(17,"td",53)(18,"span"),o(19),u(20,"number"),a()(),r(21,"td",53),o(22),a()()),i&2){let t=e.$implicit,n=C(3);l(2),R(t.functionName),l(2),$("px-2 py-1 rounded text-xs font-semibold "+(t.dependencyType==="SQL"?"bg-blue-100 text-blue-800":t.dependencyType==="HTTP"?"bg-green-100 text-green-800":t.dependencyType==="Azure blob"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800")),l(),p(" ",t.dependencyType," "),l(3),p(" ",t.dependencyName," "),l(),I(t.primaryTarget?9:-1),l(2),p(" ",f(12,14,t.totalCalls,"1.0-0")," "),l(3),$(t.failedCalls>0?"text-red-800 font-semibold":"text-gray-800"),l(),p(" ",f(16,17,t.failedCalls,"1.0-0")," "),l(3),$(t.errorRate>5?"text-red-800 font-semibold":t.errorRate>1?"text-orange-800 font-semibold":"text-green-800"),l(),p(" ",f(20,20,t.errorRate,"1.2-2"),"% "),l(3),p(" ",n.formatDuration(t.avgDuration)," ")}}function Qr(i,e){if(i&1&&(r(0,"p-table",77),W(1,$r,22,0,"ng-template",null,0,k)(3,Vr,23,23,"ng-template",null,1,k),a()),i&2){let t=C(2);y("value",t.dependencies.dependencies)("paginator",!0)("rows",15)}}function jr(i,e){i&1&&(r(0,"div",18),d(1,"i",34),r(2,"p",35),o(3,"No dependency data available"),a()())}function Gr(i,e){if(i&1&&(r(0,"p-card")(1,"div",90)(2,"div",26)(3,"div",74),o(4),u(5,"number"),a(),r(6,"div",28),o(7,"Total Dependency Calls"),a()(),r(8,"div",26)(9,"div",91),o(10),u(11,"number"),a(),r(12,"div",28),o(13,"Failed Calls"),a()(),r(14,"div",26)(15,"div",72),o(16),u(17,"number"),a(),r(18,"div",28),o(19,"Overall Error Rate"),a()()(),D(20,Qr,5,3,"p-table",77)(21,jr,4,0,"div",18),a()),i&2){let t=C();l(4),p(" ",f(5,4,t.dependencies.totalDependencyCalls,"1.0-0")," "),l(6),p(" ",f(11,7,t.dependencies.totalFailedCalls,"1.0-0")," "),l(6),p(" ",f(17,10,t.dependencies.overallErrorRate,"1.2-2"),"% "),l(4),I(t.dependencies.dependencies.length>0?20:21)}}function Xr(i,e){i&1&&(r(0,"p-card",25)(1,"div",18),d(2,"i",32),r(3,"p",33),o(4,"Loading Azure Functions data..."),a()()())}Ie.register(...ut);var tn=class i{healthService=_(G);cdr=_(U);destroyRef=_(H);timelineCanvas;coldStartCanvas;functions=[];timeline=null;resources=null;dependencies=null;loading=!1;timelineLoading=!1;resourcesLoading=!1;dependenciesLoading=!1;timelineChart=null;coldStartChart=null;timeRanges=[1,6,12,24];timeRangeOptions=this.timeRanges.map(e=>({label:e+"h",value:e}));selectedTimeRange=1;granularityOptions=[{label:"1 minute",value:"1m"},{label:"5 minutes",value:"5m"},{label:"15 minutes",value:"15m"},{label:"30 minutes",value:"30m"},{label:"1 hour",value:"1h"}];selectedGranularity="5m";expandedRows={};ngOnInit(){this.loadAllData(),this.healthService.systemHealth$.pipe(N(this.destroyRef)).subscribe(e=>{e?.azureFunctions&&(this.functions=e.azureFunctions,this.cdr.detectChanges())})}ngAfterViewInit(){this.timeline&&this.createTimelineChart(),this.resources&&this.createColdStartChart()}loadAllData(){this.loading=!0;let e=`${this.selectedTimeRange}h`;Tn({functions:this.healthService.fetchAzureFunctions(e),timeline:this.healthService.fetchFunctionTimeline(e,this.selectedGranularity),resources:this.healthService.fetchFunctionResources(e),dependencies:this.healthService.fetchFunctionDependencies(e)}).subscribe({next:t=>{this.functions=t.functions??[],this.timeline=t.timeline,this.resources=t.resources,this.dependencies=t.dependencies,this.loading=!1,this.cdr.detectChanges(),this.timelineCanvas?.nativeElement!=null&&this.createTimelineChart(),this.coldStartCanvas?.nativeElement!=null&&this.createColdStartChart()},error:t=>{console.error("Error loading Azure Functions data:",t),this.loading=!1,this.cdr.detectChanges()}})}onTimeRangeChange(e){this.selectedTimeRange=+e.value,this.loadAllData()}onGranularityChange(e){this.selectedGranularity=e.value,this.loadTimeline()}loadTimeline(){this.timelineLoading=!0;let e=`${this.selectedTimeRange}h`;this.healthService.fetchFunctionTimeline(e,this.selectedGranularity).subscribe({next:t=>{this.timeline=t,this.timelineLoading=!1,this.cdr.detectChanges(),this.timelineCanvas?.nativeElement!=null&&this.createTimelineChart()},error:t=>{console.error("Error loading timeline:",t),this.timelineLoading=!1,this.cdr.detectChanges()}})}refreshData(){this.loadAllData()}getStatusSeverity(e){switch(e){case"Healthy":return"success";case"Warning":return"warn";case"Critical":return"danger";case"Unknown":return"secondary";default:return"secondary"}}getStatusIcon(e){switch(e){case"Healthy":return"pi-check-circle";case"Warning":return"pi-exclamation-triangle";case"Critical":return"pi-times-circle";case"Unknown":return"pi-question-circle";default:return"pi-circle"}}formatDuration(e){return e<1e3?`${Math.round(e)}ms`:`${(e/1e3).toFixed(2)}s`}getFunctionDependencies(e){return this.dependencies?.dependencies.filter(t=>t.functionName===e)??[]}createTimelineChart(){let e=this.timelineCanvas?.nativeElement;if(this.timeline==null||e==null)return;let t=e.getContext("2d");if(!t)return;this.timelineChart&&this.timelineChart.destroy();let n=["#3b82f6","#8b5cf6","#ec4899","#f59e0b","#10b981","#06b6d4","#ef4444"],c={type:"line",data:{datasets:this.timeline.functionNames.map((m,v)=>{let T=this.timeline?.dataPoints.filter(S=>S.functionName===m)??[];return{label:m,data:T.map(S=>({x:new Date(S.timestamp).getTime(),y:S.executions})),borderColor:n[v%n.length],backgroundColor:n[v%n.length]+"20",borderWidth:2,tension:.4,fill:!0}})},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:15,font:{family:"Ubuntu"}}},tooltip:{callbacks:{title:m=>{let v=m[0]?.parsed?.x;return v==null||v===0?"":new Date(v).toLocaleString()},label:m=>{let v=m.dataset.label??"",T=m.parsed.y;return`${v}: ${T} execution${T===1?"":"s"}`}}}},scales:{x:{type:"time",time:{unit:"minute",displayFormats:{minute:"HH:mm",hour:"MMM d, HH:mm"}},title:{display:!0,text:"Time",font:{family:"Ubuntu"}},grid:{display:!0,color:"#f3f4f6"},ticks:{font:{family:"Ubuntu"}}},y:{beginAtZero:!0,title:{display:!0,text:"Executions",font:{family:"Ubuntu"}},ticks:{precision:0,font:{family:"Ubuntu"}},grid:{color:"#f3f4f6"}}}}};this.timelineChart=new Ie(t,c)}createColdStartChart(){let e=this.coldStartCanvas?.nativeElement;if(this.resources==null||e==null)return;let t=e.getContext("2d");if(!t)return;this.coldStartChart&&this.coldStartChart.destroy();let n=this.resources.functions.filter(c=>c.coldStarts>0).sort((c,m)=>m.coldStartRate-c.coldStartRate).slice(0,10),s={type:"bar",data:{labels:n.map(c=>c.functionName),datasets:[{label:"Cold Start Rate (%)",data:n.map(c=>c.coldStartRate),backgroundColor:"#ef4444",borderColor:"#dc2626",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1},tooltip:{callbacks:{label:c=>{let m=n[c.dataIndex];return[`Cold Start Rate: ${m.coldStartRate}%`,`Cold Starts: ${m.coldStarts}`,`Total Executions: ${m.totalExecutions}`,`Avg Cold Start: ${m.avgColdStartDuration}ms`,`Avg Warm Start: ${m.avgWarmStartDuration}ms`]}}}},scales:{x:{beginAtZero:!0,title:{display:!0,text:"Cold Start Rate (%)",font:{family:"Ubuntu"}},grid:{color:"#f3f4f6"},ticks:{font:{family:"Ubuntu"}}},y:{grid:{display:!1},ticks:{font:{family:"Ubuntu",size:11}}}}}};this.coldStartChart=new Ie(t,s)}getFunctionsWithColdStarts(){return this.resources?.functions.filter(e=>e.coldStarts>0)??[]}getTotalExecutions(){return this.functions.reduce((e,t)=>e+t.totalExecutions,0)}getAverageSuccessRate(){return this.functions.length===0?0:this.functions.reduce((t,n)=>t+n.successRate,0)/this.functions.length}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Y({type:i,selectors:[["app-azure-functions"]],viewQuery:function(t,n){if(t&1&&(_e(yr,5),_e(Sr,5)),t&2){let s;we(s=Ee())&&(n.timelineCanvas=s.first),we(s=Ee())&&(n.coldStartCanvas=s.first)}},decls:40,vars:11,consts:[["header",""],["body",""],["expandedrow",""],["timelineCanvas",""],["coldStartCanvas",""],[1,"m-4","flex","items-center","justify-between","gap-4","flex-wrap"],[1,"text-2xl","font-bold","text-gray-800"],[1,"flex","items-center","gap-4","flex-wrap"],[1,"flex","items-center","gap-2"],["for","timeRange",1,"text-sm","font-semibold","text-gray-700"],["inputId","timeRange","placeholder","Select time range",1,"min-w-[100px]",3,"ngModelChange","onChange","options","ngModel"],["icon","pi pi-refresh","label","Refresh","severity","secondary","size","small",3,"onClick","loading"],[1,"grid","grid-cols-[repeat(auto-fit,minmax(200px,1fr))]","gap-4","m-4"],["value","0",1,"m-4"],["value","0"],["value","1"],["value","2"],["value","3"],[1,"text-center","py-8","text-gray-500"],["dataKey","functionName",1,"p-datatable-sm",3,"value","paginator","rows","rowsPerPageOptions","expandedRowKeys"],[1,"mb-4","flex","items-center","gap-4"],["for","granularity",1,"text-sm","font-semibold","text-gray-700"],["inputId","granularity",1,"min-w-[150px]",3,"ngModelChange","onChange","options","ngModel"],[1,"relative","h-[400px]","w-full"],[1,"grid","gap-4"],[1,"m-4"],[1,"text-center"],[1,"text-[2rem]","font-bold","text-gray-800","mb-1"],[1,"text-sm","text-gray-800"],[1,"text-[2rem]","font-bold","text-blue-800","mb-1"],[1,"text-[2rem]","font-bold","text-green-800","mb-1"],[1,"text-[2rem]","font-bold","text-orange-800","mb-1"],[1,"pi","pi-spin","pi-spinner","text-5xl","mb-4","block"],[1,"text-lg","font-medium"],[1,"pi","pi-inbox","text-5xl","text-gray-800","mb-4","block"],[1,"text-lg","font-semibold"],[2,"width","3rem"],["pSortableColumn","functionName"],["field","functionName"],["pSortableColumn","status"],["field","status"],["pSortableColumn","totalExecutions",1,"text-right"],["field","totalExecutions"],["pSortableColumn","successRate",1,"text-right"],["field","successRate"],["pSortableColumn","avgDuration",1,"text-right"],["field","avgDuration"],["pSortableColumn","p95Duration",1,"text-right"],["field","p95Duration"],["pSortableColumn","lastExecution"],["field","lastExecution"],["pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],[3,"value","severity","icon"],[1,"text-right"],["colspan","8"],[1,"p-4"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-4"],["header","Execution Statistics"],[1,"space-y-2"],[1,"flex","justify-between","text-sm"],[1,"text-gray-800"],[1,"font-semibold"],[1,"font-semibold","text-red-800"],["header","Duration Metrics"],["header","Dependencies"],[1,"text-sm","text-gray-500"],[3,"class"],[1,"text-xs","text-gray-800"],[1,"pi","pi-chart-line","text-5xl","text-gray-800","mb-4","block"],["header","Cold Start Summary"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-3xl","font-bold","text-orange-800","mb-1"],[1,"text-3xl","font-bold","text-blue-800","mb-1"],[1,"text-3xl","font-bold","text-gray-800","mb-1"],["header","Top Functions by Cold Start Rate"],["header","Cold Start Details by Function"],[1,"p-datatable-sm",3,"value","paginator","rows"],[1,"pi","pi-check-circle","text-5xl","text-green-500","mb-4","block"],[1,"text-sm"],["pSortableColumn","coldStarts",1,"text-right"],["field","coldStarts"],["pSortableColumn","coldStartRate",1,"text-right"],["field","coldStartRate"],["pSortableColumn","avgColdStartDuration",1,"text-right"],["field","avgColdStartDuration"],["pSortableColumn","avgWarmStartDuration",1,"text-right"],["field","avgWarmStartDuration"],["pSortableColumn","coldStartImpact",1,"text-right"],["field","coldStartImpact"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-6"],[1,"text-3xl","font-bold","text-red-800","mb-1"],["pSortableColumn","dependencyType"],["field","dependencyType"],["pSortableColumn","dependencyName"],["field","dependencyName"],["pSortableColumn","totalCalls",1,"text-right"],["field","totalCalls"],["pSortableColumn","failedCalls",1,"text-right"],["field","failedCalls"],["pSortableColumn","errorRate",1,"text-right"],["field","errorRate"],[1,"text-sm","font-semibold"],[1,"text-xs","text-gray-500"]],template:function(t,n){t&1&&(r(0,"div",5)(1,"h2",6),o(2,"Azure Functions Performance"),a(),r(3,"div",7)(4,"div",8)(5,"label",9),o(6,"Time Range:"),a(),r(7,"p-select",10),q("ngModelChange",function(c){return z(n.selectedTimeRange,c)||(n.selectedTimeRange=c),c}),O("onChange",function(c){return n.onTimeRangeChange(c)}),a()(),r(8,"p-button",11),O("onClick",function(){return n.refreshData()}),a()()(),D(9,wr,28,13,"div",12),r(10,"p-tabs",13)(11,"p-tablist")(12,"p-tab",14),o(13,"Functions Overview"),a(),r(14,"p-tab",15),o(15,"Execution Timeline"),a(),r(16,"p-tab",16),o(17,"Cold Start Analysis"),a(),r(18,"p-tab",17),o(19,"Dependencies"),a()(),r(20,"p-tabpanels")(21,"p-tabpanel",14)(22,"p-card"),D(23,Er,4,0,"div",18)(24,Tr,4,0,"div",18)(25,Or,7,6,"p-table",19),a()(),r(26,"p-tabpanel",15)(27,"p-card")(28,"div",20)(29,"label",21),o(30,"Granularity:"),a(),r(31,"p-select",22),q("ngModelChange",function(c){return z(n.selectedGranularity,c)||(n.selectedGranularity=c),c}),O("onChange",function(c){return n.onGranularityChange(c)}),a()(),D(32,kr,4,0,"div",18)(33,Fr,3,0,"div",23)(34,Nr,4,0,"div",18),a()(),r(35,"p-tabpanel",16),D(36,Yr,26,11,"div",24),a(),r(37,"p-tabpanel",17),D(38,Gr,22,13,"p-card"),a()()(),D(39,Xr,5,0,"p-card",25)),t&2&&(l(7),y("options",n.timeRangeOptions),L("ngModel",n.selectedTimeRange),l(),y("loading",n.loading),l(),I(n.resources?9:-1),l(14),I(n.loading&&n.functions.length===0?23:n.functions.length===0?24:25),l(8),y("options",n.granularityOptions),L("ngModel",n.selectedGranularity),l(),I(n.timelineLoading?32:n.timeline&&n.timeline.dataPoints.length>0?33:34),l(4),I(n.resources?36:-1),l(2),I(n.dependencies?38:-1),l(),I(n.loading&&n.functions.length===0?39:-1))},dependencies:[re,de,ce,me,ge,fe,Ne,Oe,ke,pt,Fe,le,se,ue,pe,ii,Kn,ni,ti,Jn,ei,Be,He,ie,Pe],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{background-color:#f9fafb;color:#374151;font-weight:600;padding:.75rem 1rem;border-bottom:1px solid #e5e7eb}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr{transition:background-color .2s}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{opacity:.9;cursor:pointer}[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:.75rem 1rem;border-bottom:1px solid #f3f4f6}[_nghost-%COMP%]     .p-tabview .p-tabview-nav{background:transparent;border-bottom:2px solid #e5e7eb}[_nghost-%COMP%]     .p-tabview .p-tabview-nav li .p-tabview-nav-link{padding:1rem 1.5rem;color:#6b7280;font-weight:500;transition:all .2s}[_nghost-%COMP%]     .p-tabview .p-tabview-nav li .p-tabview-nav-link:hover{color:#374151;background-color:#f9fafb}[_nghost-%COMP%]     .p-tabview .p-tabview-nav li.p-highlight .p-tabview-nav-link{color:#3b82f6;border-color:#3b82f6}"]})};var Zr=()=>[],Kr=()=>[5,10,20,50];function Jr(i,e){if(i&1&&(r(0,"div",10)(1,"p-card")(2,"div",14)(3,"div",15),o(4),u(5,"number"),a(),r(6,"div",16),o(7,"Total Operations"),a()()(),r(8,"p-card")(9,"div",14)(10,"div",17),o(11),u(12,"percent"),a(),r(13,"div",16),o(14,"Total Success Rate"),a()()()()),i&2){let t=C();l(4),p(" ",xe(5,2,t.storage.totalOperations)," "),l(7),p(" ",f(12,4,t.storage.totalSuccessRate/100,"1.1-1")," ")}}function ea(i,e){i&1&&(r(0,"div",12),d(1,"i",18),r(2,"p",19),o(3,"Loading storage data..."),a()())}function ta(i,e){i&1&&(r(0,"div",12),d(1,"i",20),r(2,"p",21),o(3,"No storage data available"),a()())}function na(i,e){i&1&&(r(0,"tr"),d(1,"th",22),r(2,"th",23),o(3," Storage Type "),d(4,"p-sortIcon",24),a(),r(5,"th",25),o(6," Target "),d(7,"p-sortIcon",26),a(),r(8,"th",27),o(9," Status "),d(10,"p-sortIcon",28),a(),r(11,"th",29),o(12," Operations "),d(13,"p-sortIcon",30),a(),r(14,"th",31),o(15," Success Rate "),d(16,"p-sortIcon",32),a(),r(17,"th",33),o(18," Avg Latency "),d(19,"p-sortIcon",34),a(),r(20,"th",35),o(21," P95 Latency "),d(22,"p-sortIcon",36),a(),r(23,"th",37),o(24," Throughput "),d(25,"p-sortIcon",38),a(),r(26,"th",39),o(27," Last Activity "),d(28,"p-sortIcon",40),a()())}function ia(i,e){if(i&1&&(r(0,"tr")(1,"td"),d(2,"p-button",41),a(),r(3,"td")(4,"span",42),o(5),a()(),r(6,"td")(7,"span",43),o(8),a()(),r(9,"td"),d(10,"p-tag",44),a(),r(11,"td",45),o(12),u(13,"number"),a(),r(14,"td",45)(15,"span"),o(16),u(17,"number"),a()(),r(18,"td",45),o(19),u(20,"number"),a(),r(21,"td",45),o(22),u(23,"number"),a(),r(24,"td",45),o(25),u(26,"number"),a(),r(27,"td"),o(28),u(29,"date"),a()()),i&2){let t=e.$implicit,n=e.expanded,s=C(2);l(2),y("pRowToggler",t)("icon",n?"pi pi-chevron-down":"pi pi-chevron-right"),l(3),R(t.storageType),l(3),R(t.target),l(2),y("value",t.status)("severity",s.getStatusSeverity(t.status))("icon","pi "+s.getStatusIcon(t.status)),l(2),p(" ",f(13,15,t.totalOperations,"1.0-0")," "),l(3),$(t.successRate>=95?"text-green-800 font-semibold":t.successRate>=90?"text-yellow-800 font-semibold":"text-red-800 font-semibold"),l(),p(" ",f(17,18,t.successRate,"1.2-2"),"% "),l(3),p(" ",f(20,21,t.avgLatencyMs,"1.0-0"),"ms "),l(3),p(" ",f(23,24,t.p95LatencyMs,"1.0-0"),"ms "),l(3),p(" ",f(26,27,t.throughputOpsPerSec,"1.2-2")," ops/s "),l(3),R(f(29,30,t.lastActivity,"short"))}}function ra(i,e){if(i&1&&(r(0,"tr")(1,"td",46)(2,"div",47)(3,"h4",48),o(4),a(),r(5,"div",49)(6,"p-card",50)(7,"div",51)(8,"div",52)(9,"span",53),o(10,"Total:"),a(),r(11,"span",42),o(12),u(13,"number"),a()(),r(14,"div",52)(15,"span",53),o(16,"Successful:"),a(),r(17,"span",54),o(18),u(19,"number"),a()(),r(20,"div",52)(21,"span",53),o(22,"Failed:"),a(),r(23,"span",55),o(24),u(25,"number"),a()(),r(26,"div",52)(27,"span",53),o(28,"Error Rate:"),a(),r(29,"span",42),o(30),u(31,"number"),a()()()(),r(32,"p-card",56)(33,"div",51)(34,"div",52)(35,"span",53),o(36,"Min:"),a(),r(37,"span",42),o(38),u(39,"number"),a()(),r(40,"div",52)(41,"span",53),o(42,"P50:"),a(),r(43,"span",42),o(44),u(45,"number"),a()(),r(46,"div",52)(47,"span",53),o(48,"P95:"),a(),r(49,"span",42),o(50),u(51,"number"),a()(),r(52,"div",52)(53,"span",53),o(54,"P99:"),a(),r(55,"span",42),o(56),u(57,"number"),a()(),r(58,"div",52)(59,"span",53),o(60,"Max:"),a(),r(61,"span",42),o(62),u(63,"number"),a()()()(),r(64,"p-card",57)(65,"div",51)(66,"div",52)(67,"span",53),o(68,"Throughput:"),a(),r(69,"span",42),o(70),u(71,"number"),a()(),r(72,"div",52)(73,"span",53),o(74,"Avg Latency:"),a(),r(75,"span",42),o(76),u(77,"number"),a()(),r(78,"div",52)(79,"span",53),o(80,"Success Rate:"),a(),r(81,"span",42),o(82),u(83,"number"),a()(),r(84,"div",52)(85,"span",53),o(86,"Last Activity:"),a(),r(87,"span",42),o(88),u(89,"date"),a()()()()()()()()),i&2){let t=e.$implicit;l(4),je(" ",t.storageType," (",t.target,") - Detailed Metrics "),l(8),R(f(13,15,t.totalOperations,"1.0-0")),l(6),R(f(19,18,t.successfulOperations,"1.0-0")),l(6),R(f(25,21,t.failedOperations,"1.0-0")),l(6),p("",f(31,24,t.errorRate,"1.2-2"),"%"),l(8),p("",f(39,27,t.minLatencyMs,"1.0-0"),"ms"),l(6),p("",f(45,30,t.p50LatencyMs,"1.0-0"),"ms"),l(6),p("",f(51,33,t.p95LatencyMs,"1.0-0"),"ms"),l(6),p("",f(57,36,t.p99LatencyMs,"1.0-0"),"ms"),l(6),p("",f(63,39,t.maxLatencyMs,"1.0-0"),"ms"),l(8),p("",f(71,42,t.throughputOpsPerSec,"1.2-2")," ops/s"),l(6),p("",f(77,45,t.avgLatencyMs,"1.0-0"),"ms"),l(6),p("",f(83,48,t.successRate,"1.2-2"),"%"),l(6),R(f(89,51,t.lastActivity,"short"))}}function aa(i,e){if(i&1&&(r(0,"p-table",13),W(1,na,29,0,"ng-template",null,0,k)(3,ia,30,33,"ng-template",null,1,k)(5,ra,90,54,"ng-template",null,2,k),a()),i&2){let t=C();y("value",(t.storage==null?null:t.storage.storageServices)??Ge(5,Zr))("paginator",!0)("rows",10)("rowsPerPageOptions",Ge(6,Kr))("expandedRowKeys",t.expandedRows)}}var ln=class i{healthService=_(G);cdr=_(U);destroyRef=_(H);storage=null;loading=!1;expandedRows={};timeRanges=[6,12,24];timeRangeOptions=this.timeRanges.map(e=>({label:e+"h",value:e}));selectedTimeRange=6;ngOnInit(){this.fetchStorageData()}fetchStorageData(){this.loading=!0,this.healthService.fetchStorage(`${this.selectedTimeRange}h`).pipe(N(this.destroyRef)).subscribe({next:e=>{this.storage=e,this.loading=!1,this.cdr.detectChanges()},error:()=>{this.loading=!1,this.cdr.detectChanges()}})}onTimeRangeChange(e){this.selectedTimeRange=+e.value,this.fetchStorageData()}refreshData(){this.fetchStorageData()}getStatusSeverity(e){switch(e?.toLowerCase()){case"healthy":return"success";case"warning":return"warn";case"critical":return"danger";default:return"info"}}getStatusIcon(e){switch(e?.toLowerCase()){case"healthy":return"pi-check-circle";case"warning":return"pi-exclamation-triangle";case"critical":return"pi-times-circle";default:return"pi-info-circle"}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Y({type:i,selectors:[["app-data-storage"]],decls:14,vars:5,consts:[["header",""],["body",""],["expandedrow",""],[1,"m-4","flex","items-center","justify-between","gap-4","flex-wrap"],[1,"text-2xl","font-bold","text-gray-800"],[1,"flex","items-center","gap-4","flex-wrap"],[1,"flex","items-center","gap-2"],["for","timeRange",1,"text-sm","font-semibold","text-gray-700"],["inputId","timeRange","placeholder","Select time range",1,"min-w-[100px]",3,"ngModelChange","onChange","options","ngModel"],["icon","pi pi-refresh","label","Refresh","severity","secondary","size","small",3,"onClick","loading"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","m-4"],["header","Storage Overview",1,"m-4"],[1,"text-center","py-8","text-gray-500"],["dataKey","target",1,"p-datatable-sm",3,"value","paginator","rows","rowsPerPageOptions","expandedRowKeys"],[1,"text-center"],[1,"text-[2rem]","font-bold","text-gray-800","mb-1"],[1,"text-sm","text-gray-800"],[1,"text-[2rem]","font-bold","text-green-800","mb-1"],[1,"pi","pi-spin","pi-spinner","text-5xl","mb-4","block"],[1,"text-lg","font-medium"],[1,"pi","pi-inbox","text-5xl","text-gray-800","mb-4","block"],[1,"text-lg","font-semibold"],["scope","col",1,"w-12"],["scope","col","pSortableColumn","storageType"],["field","storageType"],["scope","col","pSortableColumn","target"],["field","target"],["scope","col","pSortableColumn","status"],["field","status"],["scope","col","pSortableColumn","totalOperations",1,"text-right"],["field","totalOperations"],["scope","col","pSortableColumn","successRate",1,"text-right"],["field","successRate"],["scope","col","pSortableColumn","avgLatencyMs",1,"text-right"],["field","avgLatencyMs"],["scope","col","pSortableColumn","p95LatencyMs",1,"text-right"],["field","p95LatencyMs"],["scope","col","pSortableColumn","throughputOpsPerSec",1,"text-right"],["field","throughputOpsPerSec"],["scope","col","pSortableColumn","lastActivity"],["field","lastActivity"],["pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],[1,"font-semibold"],[1,"text-sm"],[3,"value","severity","icon"],[1,"text-right"],["colspan","10"],[1,"p-4"],[1,"text-lg","font-semibold","mb-3"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["header","Operation Statistics"],[1,"space-y-2"],[1,"flex","justify-between","text-sm"],[1,"text-gray-800"],[1,"font-semibold","text-green-800"],[1,"font-semibold","text-red-800"],["header","Latency Percentiles"],["header","Performance Summary"]],template:function(t,n){t&1&&(r(0,"div",3)(1,"h2",4),o(2,"Data Storage"),a(),r(3,"div",5)(4,"div",6)(5,"label",7),o(6,"Time Range:"),a(),r(7,"p-select",8),q("ngModelChange",function(c){return z(n.selectedTimeRange,c)||(n.selectedTimeRange=c),c}),O("onChange",function(c){return n.onTimeRangeChange(c)}),a()(),r(8,"p-button",9),O("onClick",function(){return n.refreshData()}),a()()(),D(9,Jr,15,7,"div",10),r(10,"p-card",11),D(11,ea,4,0,"div",12)(12,ta,4,0,"div",12)(13,aa,7,7,"p-table",13),a()),t&2&&(l(7),y("options",n.timeRangeOptions),L("ngModel",n.selectedTimeRange),l(),y("loading",n.loading),l(),I(n.storage?9:-1),l(2),I(n.loading&&!n.storage?11:!(n.storage!=null&&n.storage.storageServices)||(n.storage==null||n.storage.storageServices==null?null:n.storage.storageServices.length)===0?12:13))},dependencies:[re,de,ce,me,ge,fe,Ne,Oe,ke,pt,Fe,le,se,ue,pe,Be,He,ie,Mn,Pe],encapsulation:2})};var sa=["errorTimelineCanvas"],la=(i,e)=>[i,e],ca=(i,e)=>e.timestamp;function ma(i,e){i&1&&(r(0,"div",21),d(1,"i",27),r(2,"p",28),o(3,"Loading error timeline..."),a()())}function da(i,e){i&1&&(r(0,"div",22),d(1,"canvas",null,2),a())}function pa(i,e){i&1&&(r(0,"div",21),d(1,"i",29),r(2,"p",30),o(3,"No error data available"),a(),r(4,"p",31),o(5,"Error timeline data will appear here when available"),a()())}function ua(i,e){if(i&1&&(r(0,"span",41),d(1,"i",53),o(2),a()),i&2){let t=C().$implicit;l(2),p(" ",t.count,"x ")}}function fa(i,e){if(i&1&&(r(0,"div",43)(1,"div",44),o(2," Sample Error: "),a(),r(3,"div",54),o(4),a()()),i&2){let t=C().$implicit;l(4),p(" ",t.sampleError," ")}}function ga(i,e){if(i&1&&(r(0,"div",43)(1,"div",44),o(2," Details: "),a(),r(3,"div",54),o(4),a()()),i&2){let t=C().$implicit;l(4),p(" ",t.details," ")}}function ha(i,e){if(i&1&&(r(0,"div")(1,"div",46),d(2,"i",55),o(3,"Affected Resource "),a(),r(4,"div",56),o(5),a()()),i&2){let t=C().$implicit;l(5),p(" ",t.affectedResource," ")}}function xa(i,e){if(i&1&&o(0),i&2){let t=C(2).$implicit;p(" ",t.durationMinutes," min ")}}function va(i,e){if(i&1&&(o(0),u(1,"number")),i&2){let t=C(2).$implicit;p(" ",f(1,1,t.durationMinutes/60,"1.1-1")," hours ")}}function ba(i,e){if(i&1&&(o(0),u(1,"number")),i&2){let t=C(2).$implicit;p(" ",f(1,1,t.durationMinutes/1440,"1.1-1")," days ")}}function ya(i,e){if(i&1&&(r(0,"div")(1,"div",46),d(2,"i",57),o(3,"Duration "),a(),r(4,"div",16),D(5,xa,1,1)(6,va,2,4)(7,ba,2,4),a()()),i&2){let t=C().$implicit;l(5),I(t.durationMinutes<60?5:t.durationMinutes<1440?6:7)}}function Sa(i,e){if(i&1&&(r(0,"div",32)(1,"p-card")(2,"div",33)(3,"div",34),d(4,"i",35),r(5,"div")(6,"div",36)(7,"span",37),o(8),a(),r(9,"span",38),d(10,"i",39),o(11),a(),r(12,"span",40),o(13),a(),D(14,ua,3,1,"span",41),a(),r(15,"div",42),o(16),a()()()(),r(17,"div",43)(18,"div",44),o(19," Message: "),a(),r(20,"div",16),o(21),a()(),D(22,fa,5,1,"div",43),D(23,ga,5,1,"div",43),r(24,"div",45)(25,"div")(26,"div",46),d(27,"i",47),o(28,"Source "),a(),r(29,"div",16),o(30),a()(),D(31,ha,6,1,"div"),r(32,"div")(33,"div",46),d(34,"i",48),o(35,"Unique Issues "),a(),r(36,"div",16),o(37),a()(),r(38,"div")(39,"div",46),d(40,"i",49),o(41,"Affected Operations "),a(),r(42,"div",16),o(43),a()(),r(44,"div")(45,"div",46),d(46,"i",50),o(47,"First Occurrence "),a(),r(48,"div",16),o(49),u(50,"timeAgo"),r(51,"span",51),o(52),u(53,"date"),a()()(),r(54,"div")(55,"div",46),d(56,"i",52),o(57,"Last Occurrence "),a(),r(58,"div",16),o(59),u(60,"timeAgo"),r(61,"span",51),o(62),u(63,"date"),a()()(),D(64,ya,8,1,"div"),a()()()),i&2){let t=e.$implicit,n=C(2);l(),$("border-l-4 "+n.getAlertBorderClass(t.severity)),l(3),y("ngClass",Rn(33,la,n.getSeverityIcon(t.severity),n.getSeverityColorClass(t.severity))),l(3),y("ngClass",n.getSeverityBadgeClass(t.severity)),l(),p(" ",t.severity.toUpperCase()," "),l(),y("ngClass",n.getStatusBadgeClass(t.status)),l(),y("ngClass",n.getStatusIcon(t.status)),l(),p(" ",t.status," "),l(2),p(" ",t.type," "),l(),I(t.count>1?14:-1),l(2),p(" Alert ID: ",t.id," "),l(5),R(t.message),l(),I(t.sampleError?22:-1),l(),I(t.details?23:-1),l(7),R(t.source),l(),I(t.affectedResource?31:-1),l(6),p(" ",t.uniqueIssues," "),l(6),p(" ",t.affectedOperations," "),l(6),p(" ",xe(50,23,t.firstOccurrence)," "),l(3),p(" ",f(53,25,t.firstOccurrence,"medium")," "),l(7),p(" ",xe(60,28,t.lastOccurrence)," "),l(3),p(" ",f(63,30,t.lastOccurrence,"medium")," "),l(2),I(t.durationMinutes>0?64:-1)}}function Ca(i,e){if(i&1&&it(0,Sa,65,36,"div",32,ca),i&2){let t=e.$implicit;rt(t)}}function _a(i,e){i&1&&(r(0,"div",21),d(1,"i",58),r(2,"p",30),o(3,"No alerts found"),a(),r(4,"p",31),o(5,"All systems are operating normally"),a()())}function wa(i,e){i&1&&(r(0,"p-card",26)(1,"div",21),d(2,"i",27),r(3,"p",28),o(4,"Loading alerts..."),a()()())}Ie.register(...ut);var cn=class i{healthService=_(G);cdr=_(U);destroyRef=_(H);errorTimelineCanvas;alerts=[];alertsSummary=null;errorTimeline=null;loading=!1;chartLoading=!1;chart=null;rows=10;first=0;sortField="!timestamp";sortOrder=-1;sortOptions=[{label:"Newest First",value:"!timestamp"},{label:"Oldest First",value:"timestamp"},{label:"Severity (High to Low)",value:"!severity"},{label:"Most Occurrences",value:"!count"},{label:"Most Unique Issues",value:"!uniqueIssues"},{label:"Active First",value:"!status"}];timeRanges=[6,12,24,48];timeRangeOptions=this.timeRanges.map(e=>({label:e+"h",value:e}));selectedTimeRange=6;severityFilter="all";severityOptions=[{label:"All Severities",value:"all"},{label:"Critical",value:"Critical"},{label:"Error",value:"Error"},{label:"Warning",value:"Warning"},{label:"Information",value:"Information"}];ngOnInit(){this.loadAlerts(),this.loadErrorTimeline(),this.healthService.systemHealth$.pipe(N(this.destroyRef)).subscribe(e=>{e?.alerts&&(this.alertsSummary=e.alerts,this.alerts=this.sortAlerts(e.alerts.alerts),this.cdr.detectChanges())})}ngAfterViewInit(){this.errorTimeline!==null&&this.createOrUpdateChart()}loadAlerts(){this.loading=!0,this.healthService.fetchAlerts(`${this.selectedTimeRange}h`).subscribe({next:e=>{this.alertsSummary=e,this.alerts=this.sortAlerts(e?.alerts??[]),this.loading=!1,this.cdr.detectChanges()},error:e=>{console.error("Error loading alerts:",e),this.loading=!1,this.cdr.detectChanges()}})}onTimeRangeChange(e){this.selectedTimeRange=+e.value,this.first=0,this.loadAlerts()}onSeverityFilterChange(e){this.severityFilter=e.value,this.first=0}onSortChange(e){let t=e.value;t.startsWith("!")?(this.sortOrder=-1,this.sortField=t.substring(1)):(this.sortOrder=1,this.sortField=t),this.alerts=this.sortAlerts(this.alerts)}sortAlerts(e){let t=[...e],n=this.sortField.startsWith("!")?this.sortField.substring(1):this.sortField;return t.sort((s,c)=>{let m;switch(n){case"timestamp":m=new Date(s.timestamp).getTime()-new Date(c.timestamp).getTime();break;case"severity":m=this.getSeverityWeight(s.severity)-this.getSeverityWeight(c.severity);break;case"count":m=s.count-c.count;break;case"uniqueIssues":m=s.uniqueIssues-c.uniqueIssues;break;case"status":m=this.getStatusWeight(s.status)-this.getStatusWeight(c.status);break;default:return 0}return m*this.sortOrder}),t}getSeverityWeight(e){switch(e){case"Critical":return 4;case"Error":return 3;case"Warning":return 2;case"Information":return 1;default:return 0}}getStatusWeight(e){switch(e){case"Active":return 3;case"Recent":return 2;case"Resolved":return 1;default:return 0}}getFilteredAlerts(){return this.severityFilter==="all"?this.alerts:this.alerts.filter(e=>e.severity===this.severityFilter)}getAllAlerts(){return this.getFilteredAlerts()}getSeverityIcon(e){switch(e){case"Critical":return"pi-times-circle";case"Error":return"pi-exclamation-circle";case"Warning":return"pi-exclamation-triangle";case"Information":return"pi-info-circle";default:return"pi-info-circle"}}getSeverityColorClass(e){switch(e){case"Critical":return"text-red-600";case"Error":return"text-orange-600";case"Warning":return"text-yellow-600";case"Information":return"text-blue-600";default:return"text-gray-600"}}getSeverityBadgeClass(e){switch(e){case"Critical":return"bg-red-100 text-red-800";case"Error":return"bg-orange-100 text-orange-800";case"Warning":return"bg-yellow-100 text-yellow-800";case"Information":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}}getAlertBorderClass(e){switch(e){case"Critical":return"border-red-500";case"Error":return"border-orange-500";case"Warning":return"border-yellow-500";case"Information":return"border-blue-500";default:return"border-gray-500"}}getAlertDuration(e,t){try{let n=Je(e),s=Je(t);return Oi(n,s)}catch{return"N/A"}}getStatusBadgeClass(e){switch(e){case"Active":return"bg-red-100 text-red-800 border border-red-200";case"Recent":return"bg-orange-100 text-orange-800 border border-orange-200";case"Resolved":return"bg-green-100 text-green-800 border border-green-200";default:return"bg-gray-100 text-gray-800"}}getStatusIcon(e){switch(e){case"Active":return"pi-exclamation-circle";case"Recent":return"pi-clock";case"Resolved":return"pi-check-circle";default:return"pi-info-circle"}}refreshAlerts(){this.loadAlerts(),this.loadErrorTimeline()}loadErrorTimeline(){this.chartLoading=!0,this.healthService.fetchErrorTimelineData(`${this.selectedTimeRange}h`).subscribe({next:e=>{this.errorTimeline=e,this.chartLoading=!1,this.cdr.detectChanges(),this.errorTimelineCanvas?.nativeElement!==void 0&&this.createOrUpdateChart()},error:e=>{console.error("Error loading error timeline:",e),this.chartLoading=!1,this.cdr.detectChanges()}})}createOrUpdateChart(){let e=this.errorTimelineCanvas?.nativeElement;if(!this.errorTimeline||e===void 0)return;let t=e.getContext("2d");if(!t)return;this.chart&&this.chart.destroy();let n={"Azure Functions":"#3b82f6","Cosmos DB":"#8b5cf6",PostgreSQL:"#06b6d4","Blob Storage":"#10b981","Redis Cache":"#f59e0b","Event Hub":"#ef4444","Azure Table Storage":"#ec4899"},c={type:"line",data:{datasets:this.errorTimeline.services.map(m=>{let v=this.errorTimeline;if(!v)return null;let T=v.dataPoints.filter(S=>S.service===m).map(S=>({x:new Date(S.timestamp).getTime(),y:S.errorCount}));return{label:m,data:T,borderColor:n[m]??"#6b7280",backgroundColor:(n[m]??"#6b7280")+"20",borderWidth:2,tension:.4,fill:!0}}).filter(m=>m!==null)},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,padding:15,font:{family:"Ubuntu"}}},tooltip:{callbacks:{title:m=>{let v=m[0]?.parsed?.x;return v==null?"":new Date(v).toLocaleString()},label:m=>{let v=m.dataset.label??"",T=m.parsed.y;return`${v}: ${T} error${T===1?"":"s"}`}}}},scales:{x:{type:"time",time:{unit:"minute",displayFormats:{minute:"HH:mm",hour:"MMM d, HH:mm"}},title:{display:!0,text:"Time",font:{family:"Ubuntu"}},grid:{display:!0,color:"#f3f4f6"},ticks:{font:{family:"Ubuntu"}}},y:{beginAtZero:!0,title:{display:!0,text:"Error Count",font:{family:"Ubuntu"}},ticks:{precision:0,font:{family:"Ubuntu"}},grid:{color:"#f3f4f6"}}}}};this.chart=new Ie(t,c)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Y({type:i,selectors:[["app-errors-and-alerts"]],viewQuery:function(t,n){if(t&1&&_e(sa,5),t&2){let s;we(s=Ee())&&(n.errorTimelineCanvas=s.first)}},decls:51,vars:19,consts:[["dv",""],["list",""],["errorTimelineCanvas",""],[1,"m-4","flex","items-center","justify-between","gap-4","flex-wrap"],[1,"flex","items-center","gap-4","flex-wrap"],[1,"flex","items-center","gap-2"],["for","sortBy",1,"text-sm","font-semibold","text-gray-700"],["inputId","sortBy","placeholder","Sort by","styleClass","min-w-[180px]",3,"ngModelChange","onChange","options","ngModel"],["for","severityFilter",1,"text-sm","font-semibold","text-gray-700"],["inputId","severityFilter","placeholder","All Severities","styleClass","min-w-[150px]",3,"ngModelChange","onChange","options","ngModel"],["for","timeRange",1,"text-sm","font-semibold","text-gray-700"],["inputId","timeRange","placeholder","Select time range","styleClass","min-w-[100px]",3,"ngModelChange","onChange","options","ngModel"],["icon","pi pi-refresh","label","Refresh","severity","secondary","size","small",3,"onClick","loading"],[1,"grid","grid-cols-[repeat(auto-fit,minmax(200px,1fr))]","gap-4","m-4"],[1,"text-center"],[1,"text-[2rem]","font-bold","text-gray-800","mb-1"],[1,"text-sm","text-gray-800"],[1,"text-[2rem]","font-bold","text-red-800","mb-1"],[1,"text-[2rem]","font-bold","text-orange-800","mb-1"],[1,"text-[2rem]","font-bold","text-yellow-800","mb-1"],["header","Error Timeline by Service",1,"m-4"],[1,"text-center","py-8","text-gray-500"],[1,"chart-container"],["header","Recent Alerts",1,"m-4"],["emptyMessage","No alerts found",3,"value","paginator","rows","first","alwaysShowPaginator","loading"],["pTemplate","empty"],["styleClass","m-4"],[1,"pi","pi-spin","pi-spinner","text-5xl","mb-4","block"],[1,"text-lg","font-medium"],[1,"pi","pi-chart-line","text-5xl","text-gray-800","mb-4","block"],[1,"text-lg","font-semibold"],[1,"text-sm"],[1,"mb-4"],[1,"flex","items-start","justify-between","gap-4","mb-3"],[1,"flex","items-center","gap-3"],[1,"pi","text-2xl",3,"ngClass"],[1,"flex","items-center","gap-2","mb-1","flex-wrap"],[1,"px-2","py-1","rounded","text-xs","font-bold",3,"ngClass"],[1,"px-2","py-1","rounded","text-xs","font-semibold","flex","items-center","gap-1",3,"ngClass"],[1,"pi","text-xs",3,"ngClass"],[1,"px-2","py-1","bg-gray-100","rounded","text-xs","font-medium"],[1,"px-2","py-1","bg-purple-100","text-purple-800","rounded","text-xs","font-semibold"],[1,"text-xs","text-gray-500"],[1,"mb-3"],[1,"text-sm","font-semibold","text-gray-700","mb-1"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-3","pt-3","border-t","border-gray-200"],[1,"text-xs","font-semibold","text-gray-800","mb-1"],[1,"pi","pi-box","mr-1"],[1,"pi","pi-list","mr-1"],[1,"pi","pi-sitemap","mr-1"],[1,"pi","pi-calendar-plus","mr-1"],[1,"text-xs","text-gray-500","block"],[1,"pi","pi-calendar-times","mr-1"],[1,"pi","pi-sync","mr-1"],[1,"text-xs","text-gray-800","bg-gray-50","p-2","rounded","font-mono","break-all"],[1,"pi","pi-server","mr-1"],[1,"text-sm","text-gray-800","break-all"],[1,"pi","pi-clock","mr-1"],[1,"pi","pi-check-circle","text-5xl","text-green-500","mb-4","block"]],template:function(t,n){if(t&1){let s=at();r(0,"div",3)(1,"div",4)(2,"div",5)(3,"label",6),o(4,"Sort:"),a(),r(5,"p-select",7),q("ngModelChange",function(m){return te(s),z(n.sortField,m)||(n.sortField=m),ne(m)}),O("onChange",function(m){return te(s),ne(n.onSortChange(m))}),a()(),r(6,"div",5)(7,"label",8),o(8,"Severity:"),a(),r(9,"p-select",9),q("ngModelChange",function(m){return te(s),z(n.severityFilter,m)||(n.severityFilter=m),ne(m)}),O("onChange",function(m){return te(s),ne(n.onSeverityFilterChange(m))}),a()(),r(10,"div",5)(11,"label",10),o(12,"Time Range:"),a(),r(13,"p-select",11),q("ngModelChange",function(m){return te(s),z(n.selectedTimeRange,m)||(n.selectedTimeRange=m),ne(m)}),O("onChange",function(m){return te(s),ne(n.onTimeRangeChange(m))}),a()(),r(14,"p-button",12),O("onClick",function(){return te(s),ne(n.refreshAlerts())}),a()()(),r(15,"div",13)(16,"p-card")(17,"div",14)(18,"div",15),o(19),a(),r(20,"div",16),o(21,"Total Alerts"),a()()(),r(22,"p-card")(23,"div",14)(24,"div",17),o(25),a(),r(26,"div",16),o(27,"Critical"),a()()(),r(28,"p-card")(29,"div",14)(30,"div",18),o(31),a(),r(32,"div",16),o(33,"Errors"),a()()(),r(34,"p-card")(35,"div",14)(36,"div",19),o(37),a(),r(38,"div",16),o(39,"Warnings"),a()()()(),r(40,"p-card",20),D(41,ma,4,0,"div",21)(42,da,3,0,"div",22)(43,pa,6,0,"div",21),a(),r(44,"p-card",23)(45,"p-dataview",24,0),W(47,Ca,2,0,"ng-template",null,1,k)(49,_a,6,0,"ng-template",25),a()(),D(50,wa,5,0,"p-card",26)}t&2&&(l(5),y("options",n.sortOptions),L("ngModel",n.sortField),l(4),y("options",n.severityOptions),L("ngModel",n.severityFilter),l(4),y("options",n.timeRangeOptions),L("ngModel",n.selectedTimeRange),l(),y("loading",n.loading),l(5),p(" ",(n.alertsSummary==null?null:n.alertsSummary.totalAlerts)??0," "),l(6),p(" ",(n.alertsSummary==null?null:n.alertsSummary.criticalCount)??0," "),l(6),p(" ",(n.alertsSummary==null?null:n.alertsSummary.errorCount)??0," "),l(6),p(" ",(n.alertsSummary==null?null:n.alertsSummary.warningCount)??0," "),l(4),I(n.chartLoading?41:n.errorTimeline&&n.errorTimeline.dataPoints.length>0?42:43),l(4),y("value",n.getAllAlerts())("paginator",n.getAllAlerts().length>n.rows)("rows",n.rows)("first",n.first)("alwaysShowPaginator",!1)("loading",n.loading),l(5),I(n.loading&&n.alerts.length===0?50:-1))},dependencies:[re,ot,ge,fe,st,ue,pe,le,se,de,ce,me,oi,ai,ie,Pe,si],styles:["[_nghost-%COMP%]{display:block}.chart-container[_ngcontent-%COMP%]{position:relative;height:400px}  .p-dataview .p-dataview-content{background:transparent;border:none}  .p-dataview .p-paginator{background:transparent;border:none;padding:1rem 0}  p-message{display:block}  .p-card{border-width:1px}"]})};function Ea(i,e){if(i&1&&(r(0,"div",9)(1,"p-card")(2,"div",10)(3,"div",11),o(4,"Avg Requests/sec"),a(),r(5,"div",12),o(6),u(7,"number"),a(),r(8,"div",13),o(9),u(10,"number"),a()()(),r(11,"p-card")(12,"div",10)(13,"div",11),o(14,"Avg Events/sec"),a(),r(15,"div",14),o(16),u(17,"number"),a(),r(18,"div",13),o(19),u(20,"number"),a()()(),r(21,"p-card")(22,"div",10)(23,"div",11),o(24,"Avg Dependencies/sec"),a(),r(25,"div",15),o(26),u(27,"number"),a(),r(28,"div",13),o(29,"Real-time throughput"),a()()(),r(30,"p-card")(31,"div",10)(32,"div",11),o(33,"Total Operations"),a(),r(34,"div",16),o(35),u(36,"number"),a(),r(37,"div",13),o(38),a()()()(),r(39,"div",17)(40,"p-card",18)(41,"div",19)(42,"div")(43,"div",20),o(44),u(45,"number"),a(),r(46,"div",21),o(47),u(48,"number"),a()(),d(49,"i",22),a()(),r(50,"p-card",23)(51,"div",19)(52,"div")(53,"div",24),o(54),u(55,"number"),a(),r(56,"div",21),o(57),u(58,"number"),a()(),d(59,"i",25),a()(),r(60,"p-card",26)(61,"div",19)(62,"div")(63,"div",27),o(64),u(65,"number"),a(),r(66,"div",21),o(67),u(68,"number"),a()(),d(69,"i",28),a()()()),i&2){let t=C();l(6),p(" ",f(7,13,t.throughput.averageRequestsPerSecond,"1.2-2")," "),l(3),p(" Peak: ",f(10,16,t.throughput.peakRequestsPerSecond,"1.2-2")," "),l(7),p(" ",f(17,19,t.throughput.averageEventsPerSecond,"1.2-2")," "),l(3),p(" Peak: ",f(20,22,t.throughput.peakEventsPerSecond,"1.2-2")," "),l(7),p(" ",f(27,25,t.throughput.averageDependenciesPerSecond,"1.2-2")," "),l(9),p(" ",f(36,28,t.throughput.totalRequests+t.throughput.totalEvents+t.throughput.totalDependencies,"1.0-0")," "),l(3),p("in ",t.throughput.timeRange),l(6),p(" ",f(45,31,t.throughput.totalRequests,"1.0-0")," "),l(3),p(" ",f(48,34,t.throughput.averageRequestsPerSecond,"1.2-2")," requests/sec "),l(7),p(" ",f(55,37,t.throughput.totalEvents,"1.0-0")," "),l(3),p(" ",f(58,40,t.throughput.averageEventsPerSecond,"1.2-2")," events/sec "),l(7),p(" ",f(65,43,t.throughput.totalDependencies,"1.0-0")," "),l(3),p(" ",f(68,46,t.throughput.averageDependenciesPerSecond,"1.2-2")," calls/sec ")}}function Ta(i,e){i&1&&(r(0,"div",8),d(1,"i",29),r(2,"p",30),o(3,"Loading throughput data..."),a()())}function Da(i,e){i&1&&(r(0,"div",8),d(1,"i",31),r(2,"p",32),o(3,"No throughput data available"),a(),r(4,"p",33),o(5," Throughput metrics will appear here once data is collected. "),a()())}function Ia(i,e){if(i&1&&(d(0,"p-chart",34),r(1,"div",35)(2,"div",3),d(3,"div",36),r(4,"span"),o(5,"Requests per second"),a()(),r(6,"div",3),d(7,"div",37),r(8,"span"),o(9,"Events per second"),a()(),r(10,"div",3),d(11,"div",38),r(12,"span"),o(13,"Dependencies per second"),a()()()),i&2){let t=C();y("data",t.chartData)("options",t.chartOptions)}}var mn=class i{healthService=_(G);cdr=_(U);destroyRef=_(H);throughput=null;loading=!1;chartData;chartOptions;timeRanges=[1,6,12,24];timeRangeOptions=this.timeRanges.map(e=>({label:e+"h",value:e}));selectedTimeRange=6;ngOnInit(){this.initializeChartOptions(),this.fetchThroughputData()}fetchThroughputData(){this.loading=!0,this.healthService.fetchEventFlow(`${this.selectedTimeRange}h`).pipe(N(this.destroyRef)).subscribe({next:e=>{this.throughput=e,this.updateChartData(),this.loading=!1,this.cdr.detectChanges()},error:()=>{this.loading=!1,this.cdr.detectChanges()}})}initializeChartOptions(){let e=getComputedStyle(document.documentElement),t=e.getPropertyValue("--p-text-color"),n=e.getPropertyValue("--p-text-muted-color"),s=e.getPropertyValue("--p-content-border-color");this.chartOptions={maintainAspectRatio:!1,aspectRatio:.6,plugins:{legend:{labels:{color:t}},tooltip:{mode:"index",intersect:!1}},scales:{x:{ticks:{color:n},grid:{color:s}},y:{type:"linear",display:!0,position:"left",ticks:{color:n},grid:{color:s},title:{display:!0,text:"Operations per Second",color:t}}}}}updateChartData(){if(!this.throughput?.dataPoints||this.throughput.dataPoints.length===0)return;let e=this.throughput.dataPoints.map(n=>new Date(n.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),t=getComputedStyle(document.documentElement);this.chartData={labels:e,datasets:[{label:"Requests/sec",data:this.throughput.dataPoints.map(n=>n.requestsPerSecond),fill:!1,borderColor:t.getPropertyValue("--p-blue-500"),backgroundColor:t.getPropertyValue("--p-blue-500"),tension:.4},{label:"Events/sec",data:this.throughput.dataPoints.map(n=>n.eventsPerSecond),fill:!1,borderColor:t.getPropertyValue("--p-green-500"),backgroundColor:t.getPropertyValue("--p-green-500"),tension:.4},{label:"Dependencies/sec",data:this.throughput.dataPoints.map(n=>n.dependencyCallsPerSecond),fill:!1,borderColor:t.getPropertyValue("--p-orange-500"),backgroundColor:t.getPropertyValue("--p-orange-500"),tension:.4}]}}onTimeRangeChange(e){this.selectedTimeRange=+e.value,this.fetchThroughputData()}refreshData(){this.fetchThroughputData()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Y({type:i,selectors:[["app-event-flow"]],decls:14,vars:5,consts:[[1,"m-4","flex","items-center","justify-between","gap-4","flex-wrap"],[1,"text-2xl","font-bold","text-gray-800"],[1,"flex","items-center","gap-4","flex-wrap"],[1,"flex","items-center","gap-2"],["for","timeRange",1,"text-sm","font-semibold","text-gray-700"],["inputId","timeRange","placeholder","Select time range",1,"min-w-[100px]",3,"ngModelChange","onChange","options","ngModel"],["icon","pi pi-refresh","label","Refresh","severity","secondary","size","small",3,"onClick","loading"],["header","Throughput Over Time",1,"m-4"],[1,"text-center","py-8","text-gray-500"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","m-4"],[1,"text-center"],[1,"text-sm","text-gray-800","mb-1"],[1,"text-[2rem]","font-bold","text-blue-800","mb-1"],[1,"text-xs","text-gray-500"],[1,"text-[2rem]","font-bold","text-green-800","mb-1"],[1,"text-[2rem]","font-bold","text-orange-800","mb-1"],[1,"text-[2rem]","font-bold","text-gray-800","mb-1"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4","m-4"],["header","Total Requests"],[1,"flex","items-center","justify-between"],[1,"text-3xl","font-bold","text-blue-800"],[1,"text-sm","text-gray-800","mt-1"],[1,"pi","pi-globe","text-5xl","text-blue-300"],["header","Total Events"],[1,"text-3xl","font-bold","text-green-800"],[1,"pi","pi-chart-line","text-5xl","text-green-300"],["header","Total Dependencies"],[1,"text-3xl","font-bold","text-orange-800"],[1,"pi","pi-sitemap","text-5xl","text-orange-300"],[1,"pi","pi-spin","pi-spinner","text-5xl","mb-4","block"],[1,"text-lg","font-medium"],[1,"pi","pi-chart-line","text-5xl","text-gray-800","mb-4","block"],[1,"text-lg","font-semibold"],[1,"text-sm","mt-2"],["type","line",3,"data","options"],[1,"mt-4","flex","gap-6","justify-center","text-sm"],[1,"w-4","h-4","rounded","bg-blue-500"],[1,"w-4","h-4","rounded","bg-green-500"],[1,"w-4","h-4","rounded","bg-orange-500"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"h2",1),o(2,"Event Flow & Throughput"),a(),r(3,"div",2)(4,"div",3)(5,"label",4),o(6,"Time Range:"),a(),r(7,"p-select",5),q("ngModelChange",function(c){return z(n.selectedTimeRange,c)||(n.selectedTimeRange=c),c}),O("onChange",function(c){return n.onTimeRangeChange(c)}),a()(),r(8,"p-button",6),O("onClick",function(){return n.refreshData()}),a()()(),D(9,Ea,70,49),r(10,"p-card",7),D(11,Ta,4,0,"div",8)(12,Da,6,0,"div",8)(13,Ia,14,2),a()),t&2&&(l(7),y("options",n.timeRangeOptions),L("ngModel",n.selectedTimeRange),l(),y("loading",n.loading),l(),I(n.throughput?9:-1),l(2),I(n.loading&&!n.throughput?11:!(n.throughput!=null&&n.throughput.dataPoints)||(n.throughput==null||n.throughput.dataPoints==null?null:n.throughput.dataPoints.length)===0?12:13))},dependencies:[re,de,ce,me,ge,fe,ft,ci,le,se,ue,pe,ie],encapsulation:2})};var Ra=["main"];function Ma(i,e){i&1&&d(0,"router-outlet")}var dn=class i{cdr=_(U);mainTemplate;systemHealthTabs=[{id:"overview",label:"System Overview",route:"overview",level:0},{id:"azure-functions",label:"Azure Functions",route:"azure-functions",level:0},{id:"event-flow",label:"Event Flow",route:"event-flow",level:0},{id:"data-storage",label:"Data Storage",route:"data-storage",level:0},{id:"errors-and-alerts",label:"Errors & Alerts",route:"errors-and-alerts",level:0}];router=_(Fn);activatedRoute=_(On);destroyRef=_(H);detailsService=_(mi);isContentScrollable=nt(!1);get contentScrollableActive(){return!this.isContentScrollable()}ngAfterViewInit(){this.applyTemplateToTabs(this.systemHealthTabs,this.mainTemplate),this.cdr.detectChanges()}applyTemplateToTabs(e,t){for(let n of e)n.template=t,n.children&&this.applyTemplateToTabs(n.children,t)}onTabChange(){this.detailsService.closeDetailsPanel()}ngOnInit(){let e=t=>{let n=t;for(;n.firstChild;)n=n.firstChild;let s=n.snapshot.data;return Xe(s)&&typeof s.nestedContentScrollable=="boolean"?s.nestedContentScrollable:!1};this.isContentScrollable.set(e(this.activatedRoute)),this.cdr.detectChanges(),this.router.events.pipe(In(t=>t instanceof An),En(()=>e(this.activatedRoute)),N(this.destroyRef)).subscribe(t=>{this.isContentScrollable()!==t&&(this.isContentScrollable.set(t),this.cdr.detectChanges())})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Y({type:i,selectors:[["app-system-health-container"]],viewQuery:function(t,n){if(t&1&&_e(Ra,5),t&2){let s;we(s=Ee())&&(n.mainTemplate=s.first)}},hostVars:2,hostBindings:function(t,n){t&2&&Qe("content-scrollable-inactive",n.contentScrollableActive)},decls:4,vars:2,consts:[["main",""],[1,"w-full","h-full"],["styleClass","h-full overflow-hidden",3,"tabChange","tabs","contentScrollable"]],template:function(t,n){if(t&1){let s=at();r(0,"div",1)(1,"app-dynamic-tab-panel",2),O("tabChange",function(){return te(s),ne(n.onTabChange())}),a()(),W(2,Ma,1,0,"ng-template",null,0,k)}t&2&&(l(),y("tabs",n.systemHealthTabs)("contentScrollable",!0))},dependencies:[di,kn],styles:[".p-card{border-width:1px}"]})};function Pa(i,e){i&1&&(r(0,"div",8)(1,"p-card")(2,"div",22),d(3,"i",23),r(4,"p",24),o(5,"Loading system health data..."),a()()()())}function Aa(i,e){i&1&&(r(0,"tr")(1,"th",25),o(2," Service "),d(3,"p-sortIcon",26),a(),r(4,"th",27),o(5," Type "),d(6,"p-sortIcon",28),a(),r(7,"th",29),o(8," Status "),d(9,"p-sortIcon",30),a(),r(10,"th",31),o(11," Uptime "),d(12,"p-sortIcon",32),a(),r(13,"th",33),o(14," Error Rate "),d(15,"p-sortIcon",34),a(),r(16,"th",35),o(17," Operations "),d(18,"p-sortIcon",36),a(),r(19,"th",37),o(20," Avg Response "),d(21,"p-sortIcon",38),a(),r(22,"th",39),o(23," P95 "),d(24,"p-sortIcon",40),a()())}function Oa(i,e){if(i&1&&(r(0,"tr")(1,"td"),o(2),a(),r(3,"td"),o(4),a(),r(5,"td"),d(6,"p-tag",41),a(),r(7,"td"),o(8),u(9,"number"),a(),r(10,"td")(11,"span"),o(12),u(13,"number"),a()(),r(14,"td"),o(15),u(16,"number"),a(),r(17,"td"),o(18),u(19,"number"),a(),r(20,"td"),o(21),u(22,"number"),a()()),i&2){let t=e.$implicit,n=C();l(2),R(t.service),l(2),R(t.type),l(2),y("value",t.status)("severity",n.getStatusSeverity(t.status))("rounded",!0),l(2),p("",f(9,12,t.uptimePercent,"1.2-2"),"%"),l(3),Qe("font-semibold",t.errorRatePercent>5),l(),p(" ",f(13,15,t.errorRatePercent,"1.2-2"),"% "),l(3),R(xe(16,18,t.operations)),l(3),p("",f(19,20,t.avgResponseMs,"1.0-0"),"ms"),l(3),p("",f(22,23,t.p95Ms,"1.0-0"),"ms")}}function ka(i,e){i&1&&(d(0,"i",43),r(1,"span"),o(2,"Fetching service details..."),a())}function Fa(i,e){i&1&&(d(0,"i",44),r(1,"span"),o(2,"No service data available"),a())}function Na(i,e){if(i&1&&(r(0,"tr")(1,"td",42),D(2,ka,3,0)(3,Fa,3,0),a()()),i&2){let t=C();l(2),I(t.loading()?2:3)}}function Ha(i,e){i&1&&(r(0,"tr")(1,"th",46),o(2," Function Name "),d(3,"p-sortIcon",47),a(),r(4,"th",29),o(5," Status "),d(6,"p-sortIcon",30),a(),r(7,"th",48),o(8," Executions "),d(9,"p-sortIcon",49),a(),r(10,"th",50),o(11," Success Rate "),d(12,"p-sortIcon",51),a(),r(13,"th",52),o(14," Avg Duration "),d(15,"p-sortIcon",53),a()())}function Ba(i,e){if(i&1&&(r(0,"tr")(1,"td"),o(2),a(),r(3,"td"),d(4,"p-tag",41),a(),r(5,"td"),o(6),u(7,"number"),a(),r(8,"td"),o(9),u(10,"number"),a(),r(11,"td"),o(12),u(13,"number"),a()()),i&2){let t=e.$implicit,n=C(2);l(2),R(t.functionName),l(2),y("value",t.status)("severity",n.getStatusSeverity(t.status))("rounded",!0),l(2),R(xe(7,7,t.totalExecutions)),l(3),p("",f(10,9,t.successRate,"1.2-2"),"%"),l(3),p("",f(13,12,t.avgDuration,"1.0-0"),"ms")}}function Wa(i,e){if(i&1&&(r(0,"p-card",21)(1,"p-table",45),W(2,Ha,16,0,"ng-template",18)(3,Ba,14,15,"ng-template",19),a()()),i&2){let t=C();l(),y("value",t.functions())("sortMode","multiple")("paginator",!0)("rows",10)}}var pn=class i{healthService=_(G);wsService=_($e);cdr=_(U);healthData=bn(this.healthService.systemHealth$);connected=bn(this.wsService.status$,{initialValue:!0});loading=nt(!1);services=Te(()=>this.healthData()?.overview?.services??[]);functions=Te(()=>this.healthData()?.azureFunctions??[]);healthyServicesCount=Te(()=>this.services().filter(e=>String(e.status).toLowerCase()==="healthy").length);totalServicesCount=Te(()=>this.services().length);averageErrorRate=Te(()=>{let e=this.services();return e.length===0?0:e.reduce((n,s)=>n+(Number(s.errorRatePercent)||0),0)/e.length});averageResponseTime=Te(()=>{let e=this.services();return e.length===0?0:e.reduce((n,s)=>n+(Number(s.avgResponseMs)||0),0)/e.length});timeRanges=[6,12,24];timeRangeOptions=this.timeRanges.map(e=>({label:e+"h",value:e}));selectedTimeRange=6;ngOnInit(){this.healthService.initialize(),this.refreshData()}refreshData(e){this.loading.set(!0);let t=e??`${this.selectedTimeRange}h`;this.healthService.refreshData(t),setTimeout(()=>{this.loading.set(!1),this.cdr.detectChanges()},1500)}getStatusSeverity(e){switch(e?.toLowerCase()){case"healthy":return"success";case"warning":return"warn";case"critical":return"danger";default:return"info"}}getSeverityTag(e){switch(e?.toLowerCase()){case"critical":case"error":return"danger";case"warning":return"warn";case"information":return"info";default:return"info"}}selectTimeRange(e){this.selectedTimeRange=e,this.refreshData(`${e}h`)}onTimeRangeChange(e){this.selectTimeRange(+e.value)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=Y({type:i,selectors:[["app-system-overview"]],decls:57,vars:23,consts:[[1,"m-4","flex","items-center","justify-between","gap-4","flex-wrap"],[1,"text-2xl","font-bold"],[1,"flex","items-center","gap-4","flex-wrap"],[1,"flex","items-center","gap-2"],["for","timeRange",1,"text-sm","font-semibold"],["inputId","timeRange","placeholder","Select time range",1,"min-w-[100px]",3,"ngModelChange","onChange","options","ngModel"],["icon","pi pi-refresh","label","Refresh","severity","secondary","size","small",3,"onClick","loading"],[1,"system-overview"],[1,"m-4"],[1,"p-4","rounded-md","flex","items-center","gap-2",3,"ngClass"],[1,"pi"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","m-4"],[1,"text-center"],[1,"text-sm","mb-1"],[1,"text-[2rem]","font-bold","mb-1"],[1,"text-xs"],["header","Service Health Status",1,"m-4"],[3,"value","sortMode"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Azure Functions Quick Status",1,"m-4"],[1,"text-center","py-8"],[1,"pi","pi-spin","pi-spinner","text-5xl","mb-4","block"],[1,"text-lg","font-medium"],["pSortableColumn","service","scope","col"],["field","service"],["pSortableColumn","type","scope","col"],["field","type"],["pSortableColumn","status","scope","col"],["field","status"],["pSortableColumn","uptimePercent","scope","col"],["field","uptimePercent"],["pSortableColumn","errorRatePercent","scope","col"],["field","errorRatePercent"],["pSortableColumn","operations","scope","col"],["field","operations"],["pSortableColumn","avgResponseMs","scope","col"],["field","avgResponseMs"],["pSortableColumn","p95Ms","scope","col"],["field","p95Ms"],[3,"value","severity","rounded"],["colspan","8",1,"text-center","p-8"],[1,"pi","pi-spin","pi-spinner","text-2xl","mb-2","block"],[1,"pi","pi-inbox","text-2xl","mb-2","block"],[1,"p-datatable-sm",3,"value","sortMode","paginator","rows"],["pSortableColumn","functionName","scope","col"],["field","functionName"],["pSortableColumn","totalExecutions","scope","col"],["field","totalExecutions"],["pSortableColumn","successRate","scope","col"],["field","successRate"],["pSortableColumn","avgDuration","scope","col"],["field","avgDuration"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"h2",1),o(2,"System Health Overview"),a(),r(3,"div",2)(4,"div",3)(5,"label",4),o(6,"Time Range:"),a(),r(7,"p-select",5),q("ngModelChange",function(c){return z(n.selectedTimeRange,c)||(n.selectedTimeRange=c),c}),O("onChange",function(c){return n.onTimeRangeChange(c)}),a()(),r(8,"p-button",6),O("onClick",function(){return n.refreshData()}),a()()(),r(9,"div",7)(10,"div",8)(11,"div",9),d(12,"i",10),r(13,"span"),o(14),a()()(),D(15,Pa,6,0,"div",8),r(16,"div",11)(17,"p-card")(18,"div",12)(19,"div",13),o(20,"Total Services"),a(),r(21,"div",14),o(22),a(),r(23,"div",15),o(24,"Services monitored"),a()()(),r(25,"p-card")(26,"div",12)(27,"div",13),o(28,"Healthy Services"),a(),r(29,"div",14),o(30),a(),r(31,"div",15),o(32,"Running normally"),a()()(),r(33,"p-card")(34,"div",12)(35,"div",13),o(36,"Avg Error Rate"),a(),r(37,"div",14),o(38),u(39,"number"),a(),r(40,"div",15),o(41,"Across all services"),a()()(),r(42,"p-card")(43,"div",12)(44,"div",13),o(45,"Avg Response Time"),a(),r(46,"div",14),o(47),u(48,"number"),a(),r(49,"div",15),o(50,"System latency"),a()()()(),r(51,"p-card",16)(52,"p-table",17),W(53,Aa,25,0,"ng-template",18)(54,Oa,23,26,"ng-template",19)(55,Na,4,1,"ng-template",20),a()(),D(56,Wa,4,4,"p-card",21),a()),t&2&&(l(7),y("options",n.timeRangeOptions),L("ngModel",n.selectedTimeRange),l(),y("loading",n.loading()),l(3),y("ngClass",n.connected()?"connection-online":"connection-offline"),l(),Qe("pi-wifi",n.connected())("pi-times",!n.connected()),l(2),R(n.connected()?"Real-time data connected":"Connection lost - showing cached data"),l(),I(n.loading()&&n.services().length===0?15:-1),l(7),p(" ",n.totalServicesCount()," "),l(8),p(" ",n.healthyServicesCount()," "),l(8),p(" ",f(39,17,n.averageErrorRate(),"1.2-2"),"% "),l(9),p(" ",f(48,20,n.averageResponseTime(),"1.0-0"),"ms "),l(5),y("value",n.services())("sortMode","multiple"),l(4),I(n.functions().length>0?56:-1))},dependencies:[re,ot,Ne,Oe,st,ke,Fe,Be,He,ge,fe,ri,ft,le,se,ue,pe,de,ce,me,ie],styles:["[_nghost-%COMP%]{display:block}.system-overview[_ngcontent-%COMP%]{padding-bottom:2rem}.connection-online[_ngcontent-%COMP%]{background-color:var(--p-green-100, #dcfce7);color:var(--p-green-800, #166534)}.connection-offline[_ngcontent-%COMP%]{background-color:var(--p-red-100, #fee2e2);color:var(--p-red-800, #991b1b)}"]})};var v0=[{path:"",component:dn,children:[{path:"",redirectTo:"overview",pathMatch:"full"},{path:"overview",component:pn,data:{nestedContentScrollable:!0}},{path:"azure-functions",component:tn,data:{nestedContentScrollable:!0}},{path:"event-flow",component:mn,data:{nestedContentScrollable:!0}},{path:"data-storage",component:ln,data:{nestedContentScrollable:!0}},{path:"errors-and-alerts",component:cn,data:{nestedContentScrollable:!0}}]}];export{v0 as ADMIN_SYSTEM_HEALTH_ROUTES};
