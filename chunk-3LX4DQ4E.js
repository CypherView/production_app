import{a as ot}from"./chunk-HWRGEG3G.js";import"./chunk-ZDWK5NB6.js";import{C as it,D as et,P as nt,W as _}from"./chunk-2YP72RBM.js";import"./chunk-RCAL2UNJ.js";import"./chunk-FNP4CVQN.js";import"./chunk-QVSLGYTS.js";import"./chunk-QJYXX6WB.js";import"./chunk-JJVUWK2A.js";import"./chunk-JHHTYGX5.js";import{a as Q,b as V,c as X,d as Z,e as tt}from"./chunk-FVFSV3SV.js";import"./chunk-YPVSUJNA.js";import"./chunk-UJGTUYJO.js";import"./chunk-GVCBKH6U.js";import"./chunk-PHOSYVDR.js";import"./chunk-UUBV4PLA.js";import"./chunk-T2ASJLBG.js";import"./chunk-K3QSXHYQ.js";import"./chunk-L7NFYEY5.js";import"./chunk-BEAFDC2I.js";import"./chunk-53JQ5NAG.js";import"./chunk-GV42Z4ED.js";import"./chunk-SDMJKPKX.js";import"./chunk-HBFOC76W.js";import{a as J,b as K}from"./chunk-MI5GPO5K.js";import"./chunk-PH5YALHE.js";import"./chunk-6C6CC4KT.js";import"./chunk-JAXNIEKX.js";import{K as j,Pc as R,S as I,T as M,Wc as H,Z as q,_c as G,ca as Y,f as z,sb as $,u as W}from"./chunk-FEC2V4R3.js";import{F as w,Jb as s,Kb as c,Nb as D,Ob as S,Pb as h,Qb as a,Rb as r,S as P,Sb as C,U as T,Ya as o,Yb as v,Zc as b,ba as u,cc as d,h as A,i as F,j as E,k as N,mb as k,na as L,rc as f,s as U,sb as g,sc as B,ta as m}from"./chunk-EG5ORV3B.js";import{a as O}from"./chunk-VB56BUGO.js";var x=(i,t)=>t.id;function rt(i,t){i&1&&(a(0,"div",1),C(1,"p-progressSpinner"),r())}function at(i,t){if(i&1&&(a(0,"div",2)(1,"p",4),f(2),r()()),i&2){let e=d();o(2),B(e.error())}}function st(i,t){i&1&&v(0)}function ct(i,t){i&1&&C(0,"p-divider")}function dt(i,t){if(i&1&&(g(0,st,1,0,"ng-container",11),s(1,ct,1,0,"p-divider")),i&2){let e=t.$implicit,n=t.$index,l=t.$count,p=d(2);h("ngComponentOutlet",e.component)("ngComponentOutletInputs",p.getSectionInputs(e)),o(),c(n!==l-1?1:-1)}}function lt(i,t){i&1&&v(0)}function pt(i,t){i&1&&C(0,"p-divider")}function mt(i,t){if(i&1&&(g(0,lt,1,0,"ng-container",11),s(1,pt,1,0,"p-divider")),i&2){let e=t.$implicit,n=t.$index,l=t.$count,p=d(3);h("ngComponentOutlet",e.component)("ngComponentOutletInputs",p.getSectionInputs(e)),o(),c(n!==l-1?1:-1)}}function ut(i,t){if(i&1&&(a(0,"p-accordion-panel",7)(1,"p-accordion-header")(2,"span",6),f(3,"Settings"),r()(),a(4,"p-accordion-content"),D(5,mt,2,3,null,null,x),r()()),i&2){let e=d(2);o(5),S(e.settingsSections())}}function _t(i,t){i&1&&v(0)}function Ct(i,t){i&1&&C(0,"p-divider")}function ft(i,t){if(i&1&&(g(0,_t,1,0,"ng-container",11),s(1,Ct,1,0,"p-divider")),i&2){let e=t.$implicit,n=t.$index,l=t.$count,p=d(3);h("ngComponentOutlet",e.component)("ngComponentOutletInputs",p.getSectionInputs(e)),o(),c(n!==l-1?1:-1)}}function gt(i,t){if(i&1&&(a(0,"p-accordion-panel",8)(1,"p-accordion-header")(2,"span",6),f(3,"Limits"),r()(),a(4,"p-accordion-content"),D(5,ft,2,3,null,null,x),r()()),i&2){let e=d(2);o(5),S(e.limitsSections())}}function Dt(i,t){i&1&&v(0)}function St(i,t){i&1&&C(0,"p-divider")}function ht(i,t){if(i&1&&(g(0,Dt,1,0,"ng-container",11),s(1,St,1,0,"p-divider")),i&2){let e=t.$implicit,n=t.$index,l=t.$count,p=d(3);h("ngComponentOutlet",e.component)("ngComponentOutletInputs",p.getSectionInputs(e)),o(),c(n!==l-1?1:-1)}}function vt(i,t){if(i&1&&(a(0,"p-accordion-panel",9)(1,"p-accordion-header")(2,"span",6),f(3,"Statistics"),r()(),a(4,"p-accordion-content"),D(5,ht,2,3,null,null,x),r()()),i&2){let e=d(2);o(5),S(e.statisticsSections())}}function bt(i,t){i&1&&v(0)}function xt(i,t){i&1&&C(0,"p-divider")}function yt(i,t){if(i&1&&(g(0,bt,1,0,"ng-container",11),s(1,xt,1,0,"p-divider")),i&2){let e=t.$implicit,n=t.$index,l=t.$count,p=d(3);h("ngComponentOutlet",e.component)("ngComponentOutletInputs",p.getSectionInputs(e)),o(),c(n!==l-1?1:-1)}}function Et(i,t){if(i&1&&(a(0,"p-accordion-panel",10)(1,"p-accordion-header")(2,"span",6),f(3,"Changes"),r()(),a(4,"p-accordion-content"),D(5,yt,2,3,null,null,x),r()()),i&2){let e=d(2);o(5),S(e.changesSections())}}function Tt(i,t){if(i&1&&(a(0,"div",3)(1,"p-accordion",5)(2,"p-accordion-panel",5)(3,"p-accordion-header")(4,"span",6),f(5,"Information"),r()(),a(6,"p-accordion-content"),D(7,dt,2,3,null,null,x),r()(),s(9,ut,7,0,"p-accordion-panel",7),s(10,gt,7,0,"p-accordion-panel",8),s(11,vt,7,0,"p-accordion-panel",9),s(12,Et,7,0,"p-accordion-panel",10),r()()),i&2){let e=d();o(7),S(e.informationSections()),o(2),c(e.hasSettingsSections()?9:-1),o(),c(e.hasLimitsSections()?10:-1),o(),c(e.hasStatisticsSections()?11:-1),o(),c(e.hasChangesSections()?12:-1)}}var y=class i{broadcastService=u(H);authDataService=u(G);operationRegistry=u(nt);accountsService=u(Y);informationSections=m([]);settingsSections=m([]);limitsSections=m([]);statisticsSections=m([]);changesSections=m([]);loading=m(!0);entity=m(null);error=m(null);hasInformationSections=b(()=>this.informationSections().length>0);hasSettingsSections=b(()=>this.settingsSections().length>0);hasLimitsSections=b(()=>this.limitsSections().length>0);hasStatisticsSections=b(()=>this.statisticsSections().length>0);hasChangesSections=b(()=>this.changesSections().length>0);dataStrategy=u(ot);destroyRef=u(L);route=u(j);isEntityUpdatedMessage(t){return M(t)&&t!==null&&typeof t=="object"&&"entityType"in t&&"data"in t&&t.entityType==="distributor"}constructor(){this.operationRegistry.registerEntityOperations("distributor",{update:(t,e)=>this.accountsService.updateDistributor(t,e),create:t=>this.accountsService.createDistributor(t),get:t=>this.accountsService.getDistributor(t)})}ngOnInit(){this.initializeEntityData(),this.broadcastService.on("entity-updated").pipe(R(this.destroyRef)).subscribe(t=>{this.isEntityUpdatedMessage(t)&&(this.entity.set(t.data),this.updateSectionsWithEntityData())})}initializeEntityData(){U([this.route.paramMap,this.route.parent?.parent?.data??E({})]).pipe(R(this.destroyRef),T(()=>{this.loading.set(!0),this.setupSectionStructure()}),P(([t,e])=>{let n=t.get("distributorId")??e.distributor?.id;return M(n)?F(this.dataStrategy.fetchById(n)):q(e.distributor)?N(()=>new Error("Distributor ID not found")):E(e.distributor)}),w(()=>(this.error.set("Failed to load distributor data"),A)),T(t=>{this.entity.set(t),this.loading.set(!1),this.updateSectionsWithEntityData()})).subscribe()}setupSectionStructure(){this.informationSections.set(_.createDistributorInformationSections(null));let t=this.authDataService.getUserProfile()?.owner?.id===$;this.settingsSections.set(_.createDistributorSettingsSections(null)),t&&this.limitsSections.set(_.createDistributorLimitsSections(null))}updateSectionsWithEntityData(){let t=this.entity();if(I(t))return;this.informationSections.set(_.createDistributorInformationSections(t));let e=this.authDataService.getUserProfile()?.owner?.id===$;this.settingsSections.set(_.createDistributorSettingsSections(t)),e&&this.limitsSections.set(_.createDistributorLimitsSections(t)),this.statisticsSections.set(_.createDistributorStatisticsSections(t))}async updateEntity(t){let e=this.entity();if(!I(e))try{this.loading.set(!0);let n=await this.dataStrategy.update(e.id,t);this.entity.set(n)}catch(n){this.error.set(`${n instanceof Error?n.message:String(n)}`)}finally{this.loading.set(!1)}}getSectionInputs(t){return O({},t.componentInputs)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=k({type:i,selectors:[["app-distributor-details-container"]],decls:4,vars:3,consts:[[1,"admin-details-container","h-full","flex","flex-col"],[1,"loading-container"],[1,"error-container"],[1,"details-container","h-full","flex","flex-col","overflow-hidden"],[1,"error-message"],["value","information"],[1,"uppercase"],["value","settings"],["value","limits"],["value","statistics"],["value","changes"],[4,"ngComponentOutlet","ngComponentOutletInputs"]],template:function(e,n){e&1&&(a(0,"div",0),s(1,rt,2,0,"div",1),s(2,at,3,1,"div",2),s(3,Tt,13,4,"div",3),r()),e&2&&(o(),c(n.loading()?1:-1),o(),c(n.error()?2:-1),o(),c(!n.loading()&&!n.error()?3:-1))},dependencies:[tt,Z,Q,V,X,et,it,K,J,W,z],styles:["[_nghost-%COMP%]{display:block;height:100%}  p-accordion,   .p-accordion{display:flex!important;flex-direction:column!important;height:100%!important}  p-accordion-panel,   .p-accordionpanel{display:flex!important;flex-direction:column!important;flex:0 0 auto!important}  p-accordion-panel.p-accordionpanel-active,   p-accordion-panel.p-highlight,   .p-accordionpanel.p-accordionpanel-active,   .p-accordionpanel.p-highlight{flex:1 1 auto!important;min-height:0!important;overflow:hidden!important}  p-accordion-header,   .p-accordionheader{flex:0 0 auto!important;z-index:10}  p-accordion-content,   .p-accordioncontent{flex:1 1 auto!important;overflow-y:auto!important;height:100%!important}  p-accordion-content .p-accordioncontent-content,   .p-accordioncontent .p-accordioncontent-content{min-height:100%}"]})};var ni=[{path:"",component:y}];export{ni as ADMIN_DISTRIBUTOR_DETAILS_ROUTES};
