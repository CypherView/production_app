import{a as ie}from"./chunk-X5JPT4IA.js";import"./chunk-S4LLPIXD.js";import{b as oe}from"./chunk-PDXK54JZ.js";import{C as J,D as X,E as Y,F as Z,G as ee,H as te,O as ne,P as re,j as q,n as H,r as W,z as T}from"./chunk-HBFOC76W.js";import"./chunk-PH5YALHE.js";import{l as G,m as U}from"./chunk-6C6CC4KT.js";import"./chunk-JAXNIEKX.js";import{Q as j,Rc as w,Uc as K,_c as z,u as x}from"./chunk-FEC2V4R3.js";import{F,H as k,Hc as $,Jb as A,Kb as M,Mb as P,Nb as h,Ob as y,Pb as p,Qb as o,R as I,Rb as i,Sb as m,U as N,Ya as l,Zb as B,Zc as V,ad as _,ba as S,bc as u,bd as c,cc as g,d as E,ha as L,ia as Q,j as O,mb as b,rc as v,sc as R,ta as C}from"./chunk-EG5ORV3B.js";import"./chunk-VB56BUGO.js";var me=(t,e)=>e.value;function ue(t,e){if(t&1){let r=B();o(0,"p-button",10),u("onClick",function(){let s=L(r).$implicit,a=g(2);return Q(a.onStatusChange(s.value))}),i()}if(t&2){let r=e.$implicit,n=g(2);p("label",r.label)("severity",n.selectedStatus()===r.value?"primary":"secondary")("outlined",n.selectedStatus()!==r.value)}}function ge(t,e){if(t&1&&(o(0,"div",6),h(1,ue,1,3,"p-button",9,me),i()),t&2){let r=g();l(),y(r.statusOptions())}}var D=class t{categories=c([]);sortOptions=c([]);statusOptions=c([]);selectedCategory=c("All");selectedSort=c("popular");selectedStatus=c("ALL");searchQuery=c("");searchQueryChange=_();categoryChange=_();sortChange=_();statusChange=_();onSearch(e){this.searchQueryChange.emit(e)}onCategoryChange(e){this.categoryChange.emit(e)}onSortChange(e){this.sortChange.emit(e)}onStatusChange(e){this.statusChange.emit(e)}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=b({type:t,selectors:[["app-filter-bar"]],inputs:{categories:[1,"categories"],sortOptions:[1,"sortOptions"],statusOptions:[1,"statusOptions"],selectedCategory:[1,"selectedCategory"],selectedSort:[1,"selectedSort"],selectedStatus:[1,"selectedStatus"],searchQuery:[1,"searchQuery"]},outputs:{searchQueryChange:"searchQueryChange",categoryChange:"categoryChange",sortChange:"sortChange",statusChange:"statusChange"},decls:10,vars:6,consts:[[1,"flex","flex-col","gap-4","p-4","flex-none","filter-section","border-b","border-subtle"],[1,"flex","flex-col","md:flex-row","gap-4"],[1,"relative","flex-grow"],["iconPosition","left",1,"w-full"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search integrations...",1,"w-full","border-none","shadow-none","focus:ring-2","focus:ring-primary/20",3,"ngModelChange","ngModel"],[1,"flex","gap-2"],["placeholder","Categories",1,"w-full","md:w-48",3,"onChange","options","ngModel"],["optionLabel","label","optionValue","value","placeholder","Sort By",1,"w-full","md:w-48",3,"onChange","options","ngModel"],["size","small","rounded","true",1,"!text-xs","font-semibold",3,"label","severity","outlined"],["size","small","rounded","true",1,"!text-xs","font-semibold",3,"onClick","label","severity","outlined"]],template:function(r,n){r&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"p-iconField",3),m(4,"p-inputicon",4),o(5,"input",5),u("ngModelChange",function(a){return n.onSearch(a)}),i()()(),o(6,"div",6)(7,"p-select",7),u("onChange",function(a){return n.onCategoryChange(a.value)}),i(),o(8,"p-select",8),u("onChange",function(a){return n.onSortChange(a.value)}),i()()(),A(9,ge,3,0,"div",6),i()),r&2&&(l(5),p("ngModel",n.searchQuery()),l(2),p("options",n.categories())("ngModel",n.selectedCategory()),l(),p("options",n.sortOptions())("ngModel",n.selectedSort()),l(),M(n.statusOptions().length>0?9:-1))},dependencies:[x,T,q,H,W,te,ee,Z,Y,X,J,re,ne,U,G],encapsulation:2})};var ae=["All","Fleet Management","Safety","Maintenance","Reporting"],le=[{label:"Most Popular",value:"popular"},{label:"Newest Arrivals",value:"newest"},{label:"Highest Rated",value:"rating"}];var fe=()=>[1,2,3,4,5,6,7,8],Ce=(t,e)=>e.id;function he(t,e){t&1&&m(0,"div",6)}function ye(t,e){t&1&&(o(0,"div",3),h(1,he,1,0,"div",6,P),i()),t&2&&(l(),y($(0,fe)))}function ve(t,e){if(t&1&&(o(0,"div",4)(1,"div",7),m(2,"i",8),i(),o(3,"h3",9),v(4),i(),o(5,"p",10),v(6," Please check your connection or try again later. "),i()()),t&2){let r=g();l(4),R(r.error())}}function _e(t,e){if(t&1&&m(0,"app-card",11),t&2){let r=e.$implicit;p("app",r)}}function Se(t,e){if(t&1&&(o(0,"div",3),h(1,_e,1,1,"app-card",11,Ce),i()),t&2){let r=g();l(),y(r.apps())}}function be(t,e){t&1&&(o(0,"div",5),m(1,"span",12),o(2,"h3",13),v(3,"No apps found"),i(),o(4,"p",14),v(5,"Try adjusting your search or filters."),i()())}var se=class t{appStoreService=S(oe);authDataService=S(z);clientDataService=S(K);isLoading=C(!0);error=C(null);categoryFilter=C("All");sortOrder=C("popular");categories=ae;sortOptions=le;searchInput$=new E;searchQuery$=this.searchInput$.pipe(k(250),I(""));searchQuery=w(this.searchQuery$,{initialValue:""});rawApps=w(this.appStoreService.getApps({owner:this.clientDataService.getSelectedClient()?.id??"",status:"approved"}).pipe(N(()=>this.isLoading.set(!1)),F(e=>(console.error("Error loading apps:",e),this.error.set("Unable to load apps. Please try again."),this.isLoading.set(!1),O([])))),{initialValue:[]});apps=V(()=>{let e=this.rawApps(),r=(this.searchQuery()||"").toLowerCase(),n=this.categoryFilter(),s=this.sortOrder();return e.filter(d=>{let f=d.name.toLowerCase().includes(r)||d.shortDescription.toLowerCase().includes(r),pe=n==="All"||d.categories.includes(n);return f&&pe}).sort((d,f)=>s==="popular"?f.installCount-d.installCount:s==="newest"?new Date(f.createdDate).getTime()-new Date(d.createdDate).getTime():s==="rating"?f.averageRating-d.averageRating:0)});isAdmin=this.authDataService.isSuperAdmin();onSearch(e){this.searchInput$.next(e)}onCategorySelect(e){this.categoryFilter.set(e)}onSortChange(e){this.sortOrder.set(e)}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=b({type:t,selectors:[["app-marketplace"]],decls:7,vars:6,consts:[[1,"flex","flex-col","h-full","w-full","overflow-hidden"],[3,"searchQueryChange","categoryChange","sortChange","categories","sortOptions","selectedCategory","selectedSort","searchQuery"],[1,"flex-1","min-h-0","w-full","overflow-auto","p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6"],[1,"flex","flex-col","items-center","justify-center","py-20","text-center"],[1,"text-center","py-12"],[1,"h-64","rounded-2xl","animate-pulse","border","border-subtle"],[1,"w-16","h-16","rounded-full","flex","items-center","justify-center","mb-4"],[1,"pi","pi-exclamation-triangle","text-3xl"],[1,"text-xl","font-bold","mb-2"],[1,"text-muted"],[3,"app"],[1,"pi","pi-inbox","!text-6xl","muted","mb-4"],[1,"text-lg","font-medium","mb-2"],[1,"muted"]],template:function(r,n){r&1&&(o(0,"div",0)(1,"app-filter-bar",1),u("searchQueryChange",function(a){return n.onSearch(a)})("categoryChange",function(a){return n.onCategorySelect(a)})("sortChange",function(a){return n.onSortChange(a)}),i(),o(2,"div",2),A(3,ye,3,1,"div",3)(4,ve,7,1,"div",4)(5,Se,3,0,"div",3)(6,be,6,0,"div",5),i()()),r&2&&(l(),p("categories",n.categories)("sortOptions",n.sortOptions)("selectedCategory",n.categoryFilter())("selectedSort",n.sortOrder())("searchQuery",n.searchQuery()),l(2),M(n.isLoading()?3:n.error()?4:n.apps().length>0?5:6))},dependencies:[x,j,T,ie,D],styles:[".filter-section[_ngcontent-%COMP%]{border-bottom:1px solid var(--border-subtle, #e5e7eb)}[_nghost-%COMP%]{font-family:var(--font-family);font-size:var(--base-font-size);font-weight:var(--font-weight);background:var(--main-background-color);color:var(--nav-text-color)}"]})};export{se as AppMarketplaceComponent};
