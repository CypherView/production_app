import{a as ee,b as te}from"./chunk-SR57S2NU.js";import{m as ie}from"./chunk-6C6CC4KT.js";import{xa as Z}from"./chunk-JAXNIEKX.js";import{Ib as Q,Pc as Y,S as C,T as d,U as $,V as l,X as G,Y as J,Z as A,_ as g,e as k,l as B,u as K}from"./chunk-FEC2V4R3.js";import{Aa as O,H as T,Jb as I,Kb as V,Lb as H,Nb as X,Ob as j,Pb as c,Qb as y,Rb as z,Wa as R,Ya as m,Yb as W,Zb as q,Zc as U,ba as h,bc as P,bd as o,cc as p,d as L,eb as D,ha as f,ia as S,mb as F,na as E,sb as _,ta as N,va as b}from"./chunk-EG5ORV3B.js";function re(a,e){a&1&&W(0)}function ae(a,e){if(a&1&&(y(0,"div",4)(1,"div",5),_(2,re,1,0,"ng-container",6),z()()),a&2){let t=p().$implicit;m(),c("ngClass",t.scrollable?"overflow-auto":"overflow-hidden"),m(),c("ngTemplateOutlet",t.content)}}function se(a,e){a&1&&_(0,ae,3,2,"ng-template",3)}function oe(a,e){if(a&1){let t=q();y(0,"p-splitter",2),P("touchstart",function(n){f(t);let r=p();return S(r.handleTouchStart(n))})("touchmove",function(n){f(t);let r=p();return S(r.handleTouchMove(n))})("touchend",function(n){f(t);let r=p();return S(r.handleTouchEnd(n))}),X(1,se,1,0,null,3,H),z()}if(a&2){let t=p();c("panelSizes",t.getSafePanelSizes())("layout",t.currentLayout)("minSizes",t.getMinSizes()),m(),j(t.getPanels())}}var ne=class a{localStorage=h(Q);destroyRef=h(E);panels=o([]);height=o("100%");stateKey=o("splitter-state");defaultSizes=o([]);minSizes=o([]);defaultLayout=o("horizontal");responsive=o(!0);resizeSubject=new L;static DEFAULT_MIN_SIZE=0;static DEFAULT_MAX_SIZE=100;resizeObserver=null;panelSizes=o([25,75]);currentPanelSizes=N([]);panelSizesForTemplate=[25,75];rawPanelSizes=[25,75];rawMinSizes=[];getSafePanelSizes(){let e=this.panelSizesForTemplate;return!Array.isArray(e)||e.length===0?[25,75]:e}computedPanelSizes=U(()=>{let e=this.currentPanelSizes(),t=this.defaultSizes(),i=this.panelSizes();return Array.isArray(e)&&e.length>0?e:Array.isArray(t)&&t.length>0?t:Array.isArray(i)&&i.length>0?i:[25,75]});panelStates=[];stateStorage="session";currentLayout="horizontal";currentHeight="100%";containerClass="";touchStartX=0;elementRef=h(O);renderer=h(D);constructor(){this.setupResizeListener(),b(()=>{let e=this.panelSizes(),t=this.defaultSizes();Array.isArray(e)&&e.length>0?this.rawPanelSizes=[...e]:Array.isArray(t)&&t.length>0?this.rawPanelSizes=[...t]:this.rawPanelSizes=[25,75],this.normalizeAndSetPanelSizes()}),b(()=>{let e=this.currentPanelSizes();C(this.elementRef?.nativeElement)||setTimeout(()=>this.applyHiddenPanelStyles(e),0)})}ngOnInit(){this.initializePanelStates(),this.loadSavedState(),this.currentHeight=this.height(),(!Array.isArray(this.panelSizesForTemplate)||this.panelSizesForTemplate.length===0)&&this.normalizeAndSetPanelSizes()}ngOnDestroy(){this.resizeSubject.complete(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}ngAfterViewInit(){this.applyHiddenPanelStyles(this.currentPanelSizes()),requestAnimationFrame(()=>this.normalizeAndSetPanelSizes());let e=this.elementRef.nativeElement.querySelector(".adaptive-layout")??this.elementRef.nativeElement,t=globalThis.ResizeObserver;typeof t=="function"&&(this.resizeObserver=new t(i=>{for(let n of i)n.contentRect.width>0&&this.resizeSubject.next()}),this.resizeObserver.observe(e))}getCurrentPanelSizes(){let e=this.currentPanelSizes();return Array.isArray(e)&&e.length>0?e:[25,75]}getPanels(){let e=this.panels();return Array.isArray(e)?e:[]}getMinSizes(){let e=this.minSizes();return Array.isArray(e)?(this.rawMinSizes=[...e],this.normalizeValues(e)):[]}applyHiddenPanelStyles(e){if(C(this.elementRef?.nativeElement)||A(e))return;e.includes(0)?this.renderer.addClass(this.elementRef.nativeElement,"has-hidden-panel"):this.renderer.removeClass(this.elementRef.nativeElement,"has-hidden-panel");let i=this.elementRef.nativeElement.querySelectorAll(".p-splitter-panel");if(!A(i)){for(let[n,r]of e.entries())if(n<i.length){let u=i[n];if(r===0){this.renderer.addClass(u,"zero-width-panel");let s=this.elementRef.nativeElement.querySelector(`.p-splitter-gutter:nth-of-type(${n*2+1})`);d(s)&&this.renderer.setStyle(s,"display","none")}else{this.renderer.removeClass(u,"zero-width-panel");let s=this.elementRef.nativeElement.querySelector(`.p-splitter-gutter:nth-of-type(${n*2+1})`);d(s)&&this.renderer.removeStyle(s,"display")}}}}setupResizeListener(){this.resizeSubject.pipe(T(150),Y(this.destroyRef)).subscribe({next:()=>this.normalizeAndSetPanelSizes(),error:e=>console.error("Resize error:",e)})}onResize(){this.responsive()&&this.resizeSubject.next()}initializePanelStates(){if(!G(this.panels())){console.warn("No panels provided for initialization");return}this.panelStates=this.panels().map((e,t)=>{let i=100/this.panels().length;return{size:l(i)?i:0,collapsed:!1,minSize:d(e)&&l(e.minSize)?e.minSize:a.DEFAULT_MIN_SIZE,maxSize:d(e)&&l(e.maxSize)?e.maxSize:a.DEFAULT_MAX_SIZE,hidden:!1}})}loadSavedState(){try{let e=this.localStorage.getItem(this.stateKey());if(!e){this.currentLayout=this.defaultLayout();return}let t=e;if(!this.isValidState(t))return;if(this.panelStates=t.panelStates,this.currentLayout=t.layoutMode,Array.isArray(t.panelSizes)&&t.panelSizes.length>0){let i=t.panelSizes.filter(n=>typeof n=="number"&&!Number.isNaN(n));i.length>0&&(this.currentPanelSizes.set([...i]),this.panelSizesForTemplate=[...i])}}catch(e){console.error("Error loading saved state:",e)}}isValidState(e){return J(e)&&g(e,"panelStates")&&g(e,"panelSizes")&&g(e,"layoutMode")&&Array.isArray(e.panelStates)&&Array.isArray(e.panelSizes)&&$(e.layoutMode)}calculatePercentageMoved(e){return e/window.innerWidth*100}updatePanelSize(e,t){if(!l(e)||!l(t)){console.warn("Invalid parameters for panel size update");return}let i=this.panelStates[e];if(!d(i)){console.warn("Panel not found at index:",e);return}let n=l(i.minSize)?i.minSize:10,r=l(i.maxSize)?i.maxSize:90,u=this.currentPanelSizes(),s=u[e];if(!l(s)){console.warn("Invalid current panel size");return}let w=Math.max(n,Math.min(r,s+t));if(w!==s){let x=[...u];x[e]=w;let v=x.filter(M=>typeof M=="number"&&!Number.isNaN(M));v.length>0&&(this.currentPanelSizes.set(v),this.panelSizesForTemplate=v)}}getPanelIndex(e){let t=0,i=this.currentPanelSizes();for(let n=0;n<i.length;n++)if(t+=i[n]/100*window.innerWidth,e<t)return n;return i.length-1}handleTouchStart(e){this.touchStartX=e.touches[0].clientX}handleTouchMove(e){let t=e.touches[0].clientX,i=t-this.touchStartX;if(Math.abs(i)>10){e.preventDefault();let n=this.calculatePercentageMoved(i),r=this.getPanelIndex(t);this.updatePanelSize(r,n)}}handleTouchEnd(e){this.touchStartX=0}normalizeAndSetPanelSizes(){if(this.getContainerWidth()<=0){requestAnimationFrame(()=>this.normalizeAndSetPanelSizes());return}let t=this.normalizeValues(this.rawPanelSizes),i=t.reduce((r,u)=>r+u,0),n=t;i!==100&&i>0&&(n=t.map(r=>r/i*100)),this.currentPanelSizes.set(n),this.panelSizesForTemplate=n}normalizeValues(e){if(!Array.isArray(e)||e.length===0)return[];let t=this.getContainerWidth();return e.map(i=>this.toPercent(i,t))}toPercent(e,t){if(typeof e=="number")return Number.isFinite(e)&&e>=0?e:0;let i=e.trim().toLowerCase();if(i.endsWith("px")){let r=Number.parseFloat(i.slice(0,-2));return!Number.isFinite(r)||r<0?0:t>0?r/t*100:0}let n=Number.parseFloat(i);return Number.isFinite(n)&&n>=0?n:0}getContainerWidth(){let t=(this.elementRef?.nativeElement?.querySelector(".adaptive-layout")??this.elementRef?.nativeElement)?.clientWidth??0;return Number.isFinite(t)&&t>0?t:0}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=F({type:a,selectors:[["app-adaptive-layout"]],hostBindings:function(t,i){t&1&&P("resize",function(){return i.onResize()},R)},inputs:{panels:[1,"panels"],height:[1,"height"],stateKey:[1,"stateKey"],defaultSizes:[1,"defaultSizes"],minSizes:[1,"minSizes"],defaultLayout:[1,"defaultLayout"],responsive:[1,"responsive"],panelSizes:[1,"panelSizes"]},decls:2,vars:2,consts:[[1,"adaptive-layout",3,"ngClass"],["styleClass","h-full w-full",3,"panelSizes","layout","minSizes"],["styleClass","h-full w-full",3,"touchstart","touchmove","touchend","panelSizes","layout","minSizes"],["pTemplate",""],[1,"h-full","w-full","flex","flex-col","transition-all","duration-300","ease-in-out"],[1,"flex-1","h-full",3,"ngClass"],[4,"ngTemplateOutlet"]],template:function(t,i){t&1&&(y(0,"div",0),I(1,oe,3,3,"p-splitter",1),z()),t&2&&(c("ngClass",i.containerClass),m(),V(i.getSafePanelSizes().length>0&&i.getPanels().length>0?1:-1))},dependencies:[K,k,B,te,ee,Z,ie],styles:["[_nghost-%COMP%]{display:block;height:100%;width:100%}[_nghost-%COMP%]     .adaptive-layout{display:flex;height:100%;width:100%;flex-direction:column}[_nghost-%COMP%]     .adaptive-layout .p-splitter{height:100%;min-height:100%;flex:1 1 0%}[_nghost-%COMP%]     .adaptive-layout .p-splitter-panel>div{height:100%}.has-hidden-panel[_nghost-%COMP%]     .zero-width-panel{pointer-events:none;margin:0;width:0px;min-width:0px;max-width:0px;overflow:hidden;border-width:0px;padding:0;flex:0 0 0!important}.has-hidden-panel[_nghost-%COMP%]     .zero-width-panel+.p-splitter-gutter{display:none}.has-hidden-panel[_nghost-%COMP%]     .p-splitter-panel:first-child:not(.zero-width-panel){width:100%;flex:1 1 0%}"]})};export{ne as a};
