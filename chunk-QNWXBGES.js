import{a as De}from"./chunk-KAPCDYJA.js";import{a as ke}from"./chunk-QVSLGYTS.js";import{a as Ae,b as Ee}from"./chunk-UJGTUYJO.js";import{A as Te,C as H,D as K,E as Y,G as Q,j as $,n as j,q as Pe,r as Se,t as Oe,z as Ie}from"./chunk-HBFOC76W.js";import{e as Re,f as Fe}from"./chunk-PH5YALHE.js";import{Ib as z,Jb as ve,M as ge,Pc as xe,Rc as be,S as ue,T as _,X as Ce,Yc as Me,Z as R,_c as ye,fa as fe,hd as we,n as pe,nb as D,ob as _e,qb as he,u as me,yb as V}from"./chunk-FEC2V4R3.js";import{Aa as le,Db as S,F as ne,H as N,Jb as x,Kb as b,Nb as E,Ob as k,Pb as M,Qb as a,R as oe,Rb as c,Rc as G,S as ie,Sb as C,Sc as q,Ta as W,Y as re,Ya as l,Zb as P,Zc as f,ad as T,ba as p,bc as y,bd as h,cc as s,d as J,ha as g,i as ee,ia as u,j as A,mb as U,na as ae,oc as B,qc as se,r as te,rc as d,sc as O,ta as w,tc as I,uc as de,va as ce}from"./chunk-EG5ORV3B.js";import{a as X,b as Z}from"./chunk-VB56BUGO.js";var ht=()=>{let r=p(fe),e=p(ye),t=p(Me),n=p(z),i=p(ve),o=p(ke),v=p(De),L=p(ge),F=e.getUserProfile();return F?A(F):r.getUserProfile().pipe(ie(m=>m==null?A(m):ee((async()=>(_(m.id)&&(t.setLastAuthenticatedUser(m.id),n.migrateFromPendingToUser(m.id)),await e.setUserProfile(m),i.reloadSessionsFromStorage(),m))())),ne(m=>v.isVersionMismatchError(m)?(v.handleVersionMismatch("user profile resolver"),A(null)):(o.showError("Authentication Error","Failed to load user profile. Please try logging in again."),e.clearAllUserData(),i.clearAllSessions(),t.clearAllAuthData(),L.navigate(["/auth/login"]).catch(()=>{}),A(null))))};var Ue=(r,e)=>e.id;function Ke(r,e){if(r&1){let t=P();a(0,"img",23),y("error",function(i){return g(t),u(i.target.style.display="none")}),c()}if(r&2){let t=s().$implicit;M("src",e,W)("alt",t.name)}}function Ye(r,e){if(r&1){let t=P();a(0,"button",18),y("click",function(){let i=g(t).$implicit,o=s(2);return u(o.selectClient(i.id))})("keydown",function(i){return g(t),s(2).onKeyDown(i),u(i.stopPropagation())})("focus",function(){let i=g(t).$index,o=s(2);return u(o.onItemFocus(o.getRecentClientIndex(i)))}),a(1,"div",19),x(2,Ke,1,2,"img",20),a(3,"span",21),d(4),c()(),a(5,"span",22),d(6),c()()}if(r&2){let t,n=e.$implicit,i=e.$index,o=s(2);B("focused",o.isItemFocused(o.getRecentClientIndex(i))),M("tabindex",o.getItemTabIndex(o.getRecentClientIndex(i)))("pTooltip",n.name),S("aria-label","Select recently used client: "+n.name)("aria-selected",o.isItemFocused(o.getRecentClientIndex(i))),l(),S("data-color",o.getClientColor(n.name)),l(),b((t=o.getClientLogoUrl(n.id))?2:-1,t),l(2),O(n.name.charAt(0).toUpperCase()),l(2),O(n.name)}}function Qe(r,e){if(r&1&&(a(0,"div",6)(1,"div",12),C(2,"i",13),a(3,"span"),d(4,"Recently Used"),c()(),a(5,"div",14),E(6,Ye,7,10,"button",15,Ue),c(),C(8,"div",16),a(9,"div",17),d(10,"All Clients"),c()()),r&2){let t=s();l(6),k(t.recentClients())}}function We(r,e){r&1&&(a(0,"div",8),C(1,"i",24),a(2,"span",25),d(3,"Loading clients..."),c()())}function Be(r,e){r&1&&(a(0,"div",9),C(1,"i",26),a(2,"span"),d(3,"No clients found"),c()())}function Ge(r,e){if(r&1){let t=P();a(0,"img",23),y("error",function(i){return g(t),u(i.target.style.display="none")}),c()}if(r&2){let t=s().$implicit;M("src",e,W)("alt",t.name)}}function qe(r,e){if(r&1&&(a(0,"div",32),d(1),c()),r&2){let t=s().$implicit;l(),I(" ",t.owner.name," ")}}function Xe(r,e){if(r&1){let t=P();a(0,"div",28),y("click",function(){let i=g(t).$implicit,o=s(2);return u(o.selectClient(i.id))})("keydown",function(i){return g(t),s(2).onKeyDown(i),u(i.stopPropagation())})("focus",function(){let i=g(t).$index,o=s(2);return u(o.onItemFocus(o.getClientCardIndex(i)))}),a(1,"div",29),x(2,Ge,1,2,"img",20),a(3,"span",21),d(4),c()(),a(5,"div",30)(6,"div",31),d(7),c(),x(8,qe,2,1,"div",32),c(),a(9,"div",33),C(10,"i",34),c()()}if(r&2){let t,n=e.$implicit,i=e.$index,o=s(2);B("focused",o.isItemFocused(o.getClientCardIndex(i))),M("id","client-card-"+o.getClientCardIndex(i))("tabindex",o.getItemTabIndex(o.getClientCardIndex(i))),S("aria-label","Select "+n.name+(n.owner.name?", owned by "+n.owner.name:""))("aria-selected",o.isItemFocused(o.getClientCardIndex(i)))("aria-posinset",o.first()+i+1)("aria-setsize",o.currentTotalRecords()),l(),S("data-color",o.getClientColor(n.name)),l(),b((t=o.getClientLogoUrl(n.id))?2:-1,t),l(2),O(n.name.charAt(0).toUpperCase()),l(3),O(n.name),l(),b(n.owner.name?8:-1)}}function Ze(r,e){if(r&1&&(a(0,"div",10),E(1,Xe,11,13,"div",27,Ue),c()),r&2){let t=s();l(),k(t.displayedClients())}}function Je(r,e){if(r&1){let t=P();a(0,"div",11)(1,"p-paginator",35),y("onPageChange",function(i){g(t);let o=s();return u(o.onPageChange(i))}),c()()}if(r&2){let t=s();l(),M("first",t.first())("rows",t.rows())("totalRecords",t.currentTotalRecords())}}var Le=class r{clients=h([]);loading=h(!1);useServerSearch=h(!1);totalRecords=h(0);enablePagination=h(!0);enableLazyLoad=h(!1);recentClients=h([]);clientSelected=T();searchQuery=T();lazyLoad=T();destroyRef=p(ae);elementRef=p(le);apiUrlService=p(we);search=w("");searchChanges$=new J;focusedIndex=w(-1);failedLogos=w({});first=w(0);rows=w(he);searchTerm=f(()=>this.search().trim());totalNavigableItems=f(()=>{let e=this.showRecentSection()?this.recentClients().length:0,t=this.displayedClients().length;return e+t});showRecentSection=f(()=>{let e=this.recentClients(),t=this.searchTerm();return e.length>0&&R(t)});filteredRecentClients=f(()=>{let e=this.recentClients(),t=this.searchTerm().toLowerCase();return R(t)?e:e.filter(n=>n.name.toLowerCase().includes(t))});filteredClients=f(()=>{if(this.useServerSearch())return this.clients();let e=this.searchTerm().toLowerCase();return R(e)?this.clients():this.clients().filter(n=>n.name.toLowerCase().includes(e))});displayedClients=f(()=>{let e=this.filteredClients();if(!this.enablePagination()||this.useServerSearch())return e;let t=this.first(),n=t+this.rows();return e.slice(t,n)});currentTotalRecords=f(()=>this.useServerSearch()?this.totalRecords():this.filteredClients().length);constructor(){this.searchChanges$.pipe(N(300),xe(this.destroyRef)).subscribe(e=>{this.useServerSearch()&&this.searchQuery.emit(e)})}onSearchInput(){let e=this.searchTerm();this.searchChanges$.next(e),this.focusedIndex.set(-1),this.first.set(0)}onPageChange(e){_(e.first)&&this.first.set(e.first),_(e.rows)&&this.rows.set(e.rows),this.useServerSearch()&&this.enableLazyLoad()&&this.onLazyLoad({first:e.first,rows:e.rows}),this.focusedIndex.set(-1)}selectClient(e){_(e)&&e!==""&&this.clientSelected.emit(e)}handleLogoError(e){_(e)&&e!==""&&this.failedLogos.update(t=>Z(X({},t),{[e]:!0}))}onLazyLoad(e){this.lazyLoad.emit(e)}onKeyDown(e){let n=e.target.tagName==="INPUT",i=this.totalNavigableItems();if(i===0&&!n)return;let o=this.focusedIndex();if(!["ArrowDown","ArrowUp","ArrowRight","ArrowLeft","Home","End","Enter"," "].includes(e.key))return;if(n){if([" ","ArrowLeft","ArrowRight","Home","End"].includes(e.key))return;if(e.key==="Enter"&&o<0&&i>0){e.preventDefault(),this.selectItemAtIndex(0);return}}let F={ArrowDown:()=>this.calculateNextIndexDown(o,i),ArrowUp:()=>this.calculateNextIndexUp(o),ArrowRight:()=>o<i-1?o+1:o,ArrowLeft:()=>o>0?o-1:0,Home:()=>0,End:()=>i-1,Enter:()=>(o>=0&&this.selectItemAtIndex(o),o)," ":()=>(o>=0&&this.selectItemAtIndex(o),o)}[e.key];if(typeof F=="function"){e.preventDefault();let m=F();m!==o&&m>=0&&(this.focusedIndex.set(m),this.focusItemAtIndex(m))}}calculateNextIndexDown(e,t){let i=window.innerWidth<640?1:2,o=this.showRecentSection()?this.recentClients().length:0;return e<0?0:e<o?o:Math.min(e+i,t-1)}calculateNextIndexUp(e){let n=window.innerWidth<640?1:2,i=this.showRecentSection()?this.recentClients().length:0;return e>=i&&e<i+n?i>0?i-1:e:e>=i?Math.max(e-n,i):e}onItemFocus(e){this.focusedIndex.set(e)}getItemTabIndex(e){let t=this.focusedIndex();return t<0&&e===0||t===e?0:-1}isItemFocused(e){return this.focusedIndex()===e}getRecentClientIndex(e){return e}getClientCardIndex(e){return(this.showRecentSection()?this.recentClients().length:0)+e}focusItemAtIndex(e){let t=this.showRecentSection()?this.recentClients().length:0,n,i;e<t?(n=".recent-client-chip",i=e):(n=".client-card",i=e-t);let v=this.elementRef.nativeElement.querySelectorAll(n)[i];v&&v.focus()}selectItemAtIndex(e){let t=this.showRecentSection()?this.recentClients().length:0;if(e<t){let i=this.recentClients()[e];i?.id&&this.selectClient(i.id)}else{let n=this.displayedClients(),i=e-t,o=n[i];o?.id&&this.selectClient(o.id)}}getClientColor(e){if(R(e))return V[0];let t=0;for(let i of e){let o=i.codePointAt(0);o!==void 0&&(t=o+((t<<5)-t))}let n=Math.abs(t)%V.length;return V[n]}getClientLogoUrl(e){return R(e)?"":`${this.apiUrlService.getCurrentApiUrl()}/accounts/clients/${e}/logo?size=small`}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=U({type:r,selectors:[["app-client-selection-form"]],inputs:{clients:[1,"clients"],loading:[1,"loading"],useServerSearch:[1,"useServerSearch"],totalRecords:[1,"totalRecords"],enablePagination:[1,"enablePagination"],enableLazyLoad:[1,"enableLazyLoad"],recentClients:[1,"recentClients"]},outputs:{clientSelected:"clientSelected",searchQuery:"searchQuery",lazyLoad:"lazyLoad"},decls:14,vars:5,consts:[[1,"client-selection-form","flex","flex-col","max-h-[50vh]",3,"keydown"],[1,"flex-shrink-0","my-3"],["pInputText","","placeholder","Search clients...","aria-label","Search clients","aria-describedby","client-count-description",1,"w-full",3,"ngModelChange","keydown","ngModel"],[1,"pi","pi-search"],["id","client-count-description","aria-live","polite",1,"sr-only"],[1,"flex-1","min-h-0","flex","flex-col"],[1,"recent-clients-section","mb-4","flex-shrink-0"],[1,"flex-1","min-h-0","w-full","overflow-y-auto"],[1,"client-cards-loading","flex","items-center","justify-center","h-full"],[1,"client-cards-empty","flex","flex-col","items-center","justify-center","h-full","text-[var(--text-color-secondary)]"],["role","listbox","aria-label","Available clients",1,"grid","grid-cols-1","sm:grid-cols-2","gap-3","p-1"],[1,"flex-shrink-0","pt-4","border-t","border-[var(--surface-border)]"],[1,"recent-clients-header","text-sm","font-medium","text-gray-400","mb-2","flex","items-center","gap-2"],["aria-hidden","true",1,"pi","pi-history"],["role","listbox","aria-label","Recently used clients",1,"recent-clients-chips"],["type","button","role","option","tooltipPosition","top",1,"recent-client-chip",3,"focused","tabindex","pTooltip"],[1,"border-b","border-[var(--surface-border)]","mt-4","mb-3"],[1,"text-sm","font-medium","text-gray-400","mb-2"],["type","button","role","option","tooltipPosition","top",1,"recent-client-chip",3,"click","keydown","focus","tabindex","pTooltip"],["aria-hidden","true",1,"recent-client-chip-avatar"],[1,"client-logo-img",3,"src","alt"],[1,"client-logo-fallback"],[1,"recent-client-chip-name"],[1,"client-logo-img",3,"error","src","alt"],["aria-hidden","true",1,"pi","pi-spin","pi-spinner","text-2xl","text-[var(--primary-color)]"],[1,"sr-only"],["aria-hidden","true",1,"pi","pi-inbox","text-4xl","mb-2"],["role","option",1,"client-card","flex","items-center","gap-3","p-3.5","px-4",3,"focused","id","tabindex"],["role","option",1,"client-card","flex","items-center","gap-3","p-3.5","px-4",3,"click","keydown","focus","id","tabindex"],["aria-hidden","true",1,"client-card-avatar","flex","items-center","justify-center","w-12","h-12","min-w-[3rem]"],[1,"client-card-content","flex-1","min-w-0","flex","flex-col","gap-0.5"],[1,"client-card-name","truncate"],[1,"client-card-owner","truncate"],["aria-hidden","true",1,"client-card-action","flex","items-center","justify-center"],[1,"pi","pi-chevron-right"],[1,"custom-paginator",3,"onPageChange","first","rows","totalRecords"]],template:function(t,n){t&1&&(a(0,"div",0),y("keydown",function(o){return n.onKeyDown(o)}),a(1,"div",1)(2,"p-iconfield")(3,"input",2),y("ngModelChange",function(o){return n.search.set(o),n.onSearchInput()})("keydown",function(o){return n.onKeyDown(o),o.stopPropagation()}),c(),C(4,"p-inputicon",3),c(),a(5,"div",4),d(6),c()(),a(7,"div",5),x(8,Qe,11,0,"div",6),a(9,"div",7),x(10,We,4,0,"div",8)(11,Be,4,0,"div",9)(12,Ze,3,0,"div",10),c(),x(13,Je,2,3,"div",11),c()()),t&2&&(l(3),M("ngModel",n.search()),l(3),I(" ",n.filteredClients().length," clients found "),l(2),b(n.showRecentSection()?8:-1),l(2),b(n.loading()?10:n.displayedClients().length===0?11:12),l(3),b(n.enablePagination()&&n.currentTotalRecords()>n.rows()?13:-1))},dependencies:[Ie,$,j,Se,K,H,Y,Q,Fe,Re,Ee,Ae],styles:['.client-selection-form[_ngcontent-%COMP%]   .accounts[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.recent-clients-section[_ngcontent-%COMP%]   .recent-clients-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;max-height:6rem;overflow-y:auto;padding:.25rem}.recent-client-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.375rem .875rem .375rem .375rem;background:linear-gradient(to bottom,var(--surface-card),var(--surface-ground));border:1px solid rgba(var(--primary-color-rgb, 55, 139, 192),.15);border-radius:9999px;cursor:pointer;transition:all .25s cubic-bezier(.4,0,.2,1);font-family:inherit;font-size:.875rem;font-weight:500;color:var(--text-color);max-width:200px;white-space:nowrap;box-shadow:0 1px 2px #0000000a;position:relative;overflow:hidden}.recent-client-chip[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);transition:left .5s ease}.recent-client-chip[_ngcontent-%COMP%]:hover{background:linear-gradient(to bottom,rgba(var(--primary-color-rgb, 55, 139, 192),.08),rgba(var(--primary-color-rgb, 55, 139, 192),.05));border-color:rgba(var(--primary-color-rgb, 55, 139, 192),.35);box-shadow:0 2px 8px rgba(var(--primary-color-rgb, 55, 139, 192),.15),0 1px 3px #00000014;transform:translateY(-1px)}.recent-client-chip[_ngcontent-%COMP%]:hover:before{left:100%}.recent-client-chip[_ngcontent-%COMP%]:focus{outline:none;border-color:rgba(var(--primary-color-rgb, 55, 139, 192),.5);box-shadow:0 0 0 3px rgba(var(--primary-color-rgb, 55, 139, 192),.12),0 2px 8px rgba(var(--primary-color-rgb, 55, 139, 192),.15)}.recent-client-chip[_ngcontent-%COMP%]:focus-visible{outline:none;border-color:rgba(var(--primary-color-rgb, 55, 139, 192),.5);box-shadow:0 0 0 3px rgba(var(--primary-color-rgb, 55, 139, 192),.12),0 2px 8px rgba(var(--primary-color-rgb, 55, 139, 192),.15)}.recent-client-chip.focused[_ngcontent-%COMP%]{background:linear-gradient(to bottom,rgba(var(--primary-color-rgb, 55, 139, 192),.08),rgba(var(--primary-color-rgb, 55, 139, 192),.05));border-color:rgba(var(--primary-color-rgb, 55, 139, 192),.5);box-shadow:0 0 0 3px rgba(var(--primary-color-rgb, 55, 139, 192),.12),0 2px 8px rgba(var(--primary-color-rgb, 55, 139, 192),.15)}.recent-client-chip[_ngcontent-%COMP%]:active{transform:translateY(0) scale(.98);box-shadow:0 0 0 3px rgba(var(--primary-color-rgb, 55, 139, 192),.12),0 1px 2px #00000014}.recent-client-chip-avatar[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;width:1.625rem;height:1.625rem;min-width:1.625rem;overflow:hidden;border-radius:.25rem;background:linear-gradient(135deg,rgba(255,255,255,.1),transparent);box-shadow:0 1px 2px #0000000d}.recent-client-chip-avatar[_ngcontent-%COMP%]   .client-logo-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain;filter:brightness(1.05) contrast(1.02)}.recent-client-chip-avatar[_ngcontent-%COMP%]   .client-logo-fallback[_ngcontent-%COMP%]{display:none}.recent-client-chip-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;letter-spacing:.01em;position:relative;z-index:1}.client-card[_ngcontent-%COMP%]{background-color:var(--surface-card);border:1px solid var(--surface-border);border-radius:var(--border-radius, .375rem);cursor:pointer;transition:all .2s ease}.client-card[_ngcontent-%COMP%]:hover{background-color:var(--surface-hover);border-color:var(--primary-color, #378bc0);transform:translateY(-1px);box-shadow:0 2px 8px #00000014}.client-card[_ngcontent-%COMP%]:focus{outline:2px solid var(--primary-color, #378bc0);outline-offset:2px}.client-card[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-color, #378bc0);outline-offset:2px}.client-card.focused[_ngcontent-%COMP%]{outline:2px solid var(--primary-color, #378bc0);outline-offset:2px;background-color:var(--surface-hover);border-color:var(--primary-color, #378bc0);transform:translateY(-1px);box-shadow:0 2px 8px #00000014}.client-card[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:none}.client-card-avatar[_ngcontent-%COMP%]{position:relative;overflow:hidden}.client-card-avatar[_ngcontent-%COMP%]   .client-logo-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}.client-card-avatar[_ngcontent-%COMP%]   .client-logo-fallback[_ngcontent-%COMP%]{display:none}.client-card-name[_ngcontent-%COMP%]{font-size:.9375rem;font-weight:500;color:var(--text-color)}.client-card-owner[_ngcontent-%COMP%]{font-size:.8125rem;color:var(--text-color-secondary)}.client-card-action[_ngcontent-%COMP%]{color:var(--text-color-secondary);opacity:0;transition:opacity .2s ease,transform .2s ease}.client-card[_ngcontent-%COMP%]:hover   .client-card-action[_ngcontent-%COMP%], .client-card[_ngcontent-%COMP%]:focus   .client-card-action[_ngcontent-%COMP%], .client-card.focused[_ngcontent-%COMP%]   .client-card-action[_ngcontent-%COMP%]{opacity:1;transform:translate(2px)}.client-card-action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.875rem}.client-cards-loading[_ngcontent-%COMP%], .client-cards-empty[_ngcontent-%COMP%]{min-height:200px}[_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]{background:transparent;border:none;padding:0}[_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-pages[_ngcontent-%COMP%]   .p-paginator-page[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-first[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-prev[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-next[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-last[_ngcontent-%COMP%]{height:2.25rem;min-width:2.25rem;border-radius:.5rem;margin:0 .125rem;transition:all .2s ease;color:var(--text-color-secondary);border:1px solid transparent}[_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-pages[_ngcontent-%COMP%]   .p-paginator-page[_ngcontent-%COMP%]:not(.p-highlight):not(.p-disabled):hover, [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-first[_ngcontent-%COMP%]:not(.p-highlight):not(.p-disabled):hover, [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-prev[_ngcontent-%COMP%]:not(.p-highlight):not(.p-disabled):hover, [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-next[_ngcontent-%COMP%]:not(.p-highlight):not(.p-disabled):hover, [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-last[_ngcontent-%COMP%]:not(.p-highlight):not(.p-disabled):hover{background:var(--surface-hover);color:var(--text-color);border-color:var(--surface-border)}[_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-pages[_ngcontent-%COMP%]   .p-paginator-page.p-highlight[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-first.p-highlight[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-prev.p-highlight[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-next.p-highlight[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-last.p-highlight[_ngcontent-%COMP%]{background:rgba(var(--primary-color-rgb, 55, 139, 192),.1);color:var(--primary-color);border-color:rgba(var(--primary-color-rgb, 55, 139, 192),.3);font-weight:600}[_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-pages[_ngcontent-%COMP%]   .p-paginator-page.p-disabled[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-first.p-disabled[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-prev.p-disabled[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-next.p-disabled[_ngcontent-%COMP%], [_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-paginator-last.p-disabled[_ngcontent-%COMP%]{opacity:.5}[_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-dropdown[_ngcontent-%COMP%]{height:2.25rem;border-radius:.5rem;background:var(--surface-card);border:1px solid var(--surface-border);margin-left:1rem}[_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-dropdown[_ngcontent-%COMP%]:hover{border-color:var(--primary-color)}[_nghost-%COMP%]   [_ngcontent-%COMP%]::v-deep   .custom-paginator[_ngcontent-%COMP%]   .p-dropdown[_ngcontent-%COMP%]   .p-dropdown-label[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem}']})};var Ve=class r{localStorageService=p(z);recentClientsSignal=w([]);recentClients=f(()=>this.recentClientsSignal());constructor(){ce(()=>{let e=this.localStorageService.getCurrentUserId();if(ue(e)){this.recentClientsSignal.set([]);return}this.localStorageService.migrateToNamespace(D,!0),this.localStorageService.pruneIncorrectRecentClients(),this.loadRecentClients()})}loadRecentClients(){try{let e=this.localStorageService.getItem(D);if(_(e)&&Ce(e)){let t=e.filter(n=>_(n)&&_(n.id)&&_(n.name)&&typeof n.id=="string"&&typeof n.name=="string");this.recentClientsSignal.set(t)}else this.recentClientsSignal.set([])}catch(e){console.warn("Failed to load recent clients from localStorage:",e),this.recentClientsSignal.set([])}}addRecentClient(e,t){if(!e||!t){console.warn("Cannot add recent client: missing id or name");return}try{let n=[...this.recentClientsSignal()],i=n.findIndex(L=>L.id===e);i!==-1&&n.splice(i,1);let o={id:e,name:t,lastSelectedAt:Date.now()};n.unshift(o);let v=n.slice(0,_e);this.recentClientsSignal.set(v),this.saveToStorage(v)}catch(n){console.warn("Failed to add recent client:",n)}}removeRecentClient(e){if(e)try{let t=this.recentClientsSignal(),n=t.filter(i=>i.id!==e);n.length!==t.length&&(this.recentClientsSignal.set(n),this.saveToStorage(n))}catch(t){console.warn("Failed to remove recent client:",t)}}clearRecentClients(){try{this.recentClientsSignal.set([]),this.localStorageService.removeItem(D)}catch(e){console.warn("Failed to clear recent clients:",e)}}isRecentClient(e){return this.recentClientsSignal().some(t=>t.id===e)}getRecentClientsCount(){return this.recentClientsSignal().length}saveToStorage(e){try{this.localStorageService.setItem(D,e)}catch(t){console.warn("Failed to save recent clients to localStorage:",t)}}static \u0275fac=function(t){return new(t||r)};static \u0275prov=re({token:r,factory:r.\u0275fac,providedIn:"root"})};var et=(r,e)=>e.id;function tt(r,e){r&1&&(a(0,"div",8),C(1,"i",10),a(2,"span"),d(3,"No accounts found"),c()())}function nt(r,e){if(r&1&&(a(0,"div",16),d(1),G(2,"titlecase"),c()),r&2){let t=s().$implicit;l(),de(" ",q(2,2,t.owner.type),": ",t.owner.name," ")}}function ot(r,e){if(r&1){let t=P();a(0,"div",12),G(1,"titlecase"),y("click",function(){let i=g(t).$implicit,o=s(2);return u(o.selectAccount(i.id))})("keydown.enter",function(){let i=g(t).$implicit,o=s(2);return u(o.selectAccount(i.id))})("keydown.space",function(i){let o=g(t).$implicit;return s(2).selectAccount(o.id),u(i.preventDefault())}),a(2,"div",13),d(3),c(),a(4,"div",14)(5,"div",15),d(6),c(),x(7,nt,3,4,"div",16),c(),a(8,"div",17),C(9,"i",18),c()()}if(r&2){let t=e.$implicit,n=e.$index,i=s(2);M("id","account-card-"+n),S("aria-label","Select "+t.name+(t.owner.name?", "+q(1,7,t.owner.type)+": "+t.owner.name:""))("aria-posinset",n+1)("aria-setsize",i.filteredAccounts().length),l(3),I(" ",t.name.charAt(0).toUpperCase()," "),l(3),O(t.name),l(),b(t.owner.name?7:-1)}}function it(r,e){if(r&1&&(a(0,"div",9),E(1,ot,10,9,"div",11,et),c()),r&2){let t=s();l(),k(t.filteredAccounts())}}var ze=class r{clientAccounts=h([]);maxHeightClass=h("max-h-96");accountSelected=T();searchControl=new Pe("");filteredAccounts=f(()=>{let e=this.searchTerm().toLowerCase().trim();return this.clientAccounts().filter(t=>t.name.toLowerCase().includes(e)||(t?.owner?.name??"").toLowerCase().includes(e)||(t?.owner?.type??"").toLowerCase().includes(e))});searchTerm=be(this.searchControl.valueChanges.pipe(oe(""),N(300),te(e=>e??"")),{initialValue:""});selectAccount(e){let t=this.clientAccounts().find(n=>n.id===e);t&&this.accountSelected.emit(t)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=U({type:r,selectors:[["app-client-selector"]],inputs:{clientAccounts:[1,"clientAccounts"],maxHeightClass:[1,"maxHeightClass"]},outputs:{accountSelected:"accountSelected"},decls:13,vars:5,consts:[["searchInput",""],[1,"client-selector","space-y-4"],["id","account-selection-live-region","aria-live","polite","aria-atomic","true",1,"sr-only"],[1,"w-full"],[1,"p-inputgroup"],["type","text","pInputText","","placeholder","Search accounts...","aria-label","Search accounts","aria-describedby","account-count-description",1,"w-full",3,"formControl"],[1,"pi","pi-search"],["id","account-count-description",1,"sr-only"],[1,"account-cards-empty","flex","flex-col","items-center","justify-center","py-8","text-[var(--text-color-secondary)]"],["role","listbox","aria-label","Available accounts",1,"account-cards-grid"],[1,"pi","pi-inbox","text-4xl","mb-2"],["tabindex","0","role","option","aria-selected","false",1,"account-card",3,"id"],["tabindex","0","role","option","aria-selected","false",1,"account-card",3,"click","keydown.enter","keydown.space","id"],["aria-hidden","true",1,"account-card-avatar"],[1,"account-card-content"],[1,"account-card-name"],[1,"account-card-owner"],["aria-hidden","true",1,"account-card-action"],[1,"pi","pi-chevron-right"]],template:function(t,n){t&1&&(a(0,"div",1),C(1,"div",2),a(2,"div",3)(3,"div",4)(4,"p-iconfield"),C(5,"input",5,0)(7,"p-inputicon",6),c()(),a(8,"div",7),d(9),c()(),a(10,"div"),x(11,tt,4,0,"div",8)(12,it,3,0,"div",9),c()()),t&2&&(l(5),M("formControl",n.searchControl),l(4),I(" ",n.filteredAccounts().length," accounts available "),l(),se("flex flex-col w-full overflow-y-auto rounded "+n.maxHeightClass()),l(),b(n.filteredAccounts().length===0?11:12))},dependencies:[me,Te,$,j,Oe,Q,K,H,Y,pe],styles:["[_nghost-%COMP%]{display:block;width:100%;max-width:600px;margin:auto;padding:0 1rem;--p-iconfield-icon-color: var(--color-primary-color, #378bc0)}@media(min-width:640px){[_nghost-%COMP%]{padding:0}}.sr-only[_ngcontent-%COMP%]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}.account-cards-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:.75rem;padding:.25rem}@media(min-width:640px){.account-cards-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}.account-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.875rem 1rem;background-color:var(--surface-card);border:1px solid var(--surface-border);border-radius:var(--border-radius, .375rem);cursor:pointer;transition:all .2s ease}.account-card[_ngcontent-%COMP%]:hover{background-color:var(--surface-hover);border-color:var(--primary-color, #378bc0);transform:translateY(-1px);box-shadow:0 2px 8px #00000014}.account-card[_ngcontent-%COMP%]:focus{outline:2px solid var(--primary-color, #378bc0);outline-offset:2px}.account-card[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-color, #378bc0);outline-offset:2px}.account-card.focused[_ngcontent-%COMP%]{outline:2px solid var(--primary-color, #378bc0);outline-offset:2px;background-color:var(--surface-hover);border-color:var(--primary-color, #378bc0);transform:translateY(-1px);box-shadow:0 2px 8px #00000014}.account-card[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:none}.account-card-avatar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:2.5rem;height:2.5rem;min-width:2.5rem;background-color:var(--color-primary-color, #378bc0);color:#fff;font-size:1rem;font-weight:600;border-radius:50%;text-transform:uppercase}.account-card-content[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:.125rem}.account-card-name[_ngcontent-%COMP%]{font-size:.9375rem;font-weight:500;color:var(--text-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.account-card-owner[_ngcontent-%COMP%]{font-size:.8125rem;color:var(--text-color-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.account-card-action[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;color:var(--text-color-secondary);opacity:0;transition:opacity .2s ease,transform .2s ease}.account-card[_ngcontent-%COMP%]:hover   .account-card-action[_ngcontent-%COMP%], .account-card[_ngcontent-%COMP%]:focus   .account-card-action[_ngcontent-%COMP%], .account-card.focused[_ngcontent-%COMP%]   .account-card-action[_ngcontent-%COMP%]{opacity:1;transform:translate(2px)}.account-card-action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.875rem}.account-cards-empty[_ngcontent-%COMP%]{min-height:200px}"]})};export{Le as a,Ve as b,ze as c,ht as d};
